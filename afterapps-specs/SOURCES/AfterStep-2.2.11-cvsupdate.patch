--- afterstep/applications/aboutinfo.desktop	2008-02-02 10:57:12.000000000 -0600
+++ afterstep/applications/aboutinfo.desktop	2011-12-06 20:51:36.000000000 -0600
@@ -9,6 +9,7 @@
 Encoding=UTF-8
 Categories=AfterStepInfo
 TryExec=ASRun
+Name[pl]=Strona domowa AfterStepa
 
 [Desktop Entry]
 Name=New in this version
@@ -21,6 +22,7 @@
 Encoding=UTF-8
 Categories=AfterStepInfo
 TryExec=ASRun
+Name[pl]=Nowości w tej wersji
 
 [Desktop Entry]
 Name=Supported standards
@@ -33,6 +35,7 @@
 Encoding=UTF-8
 Categories=AfterStepInfo
 TryExec=ASRun
+Name[pl]=Obsługiwane standardy
 
 [Desktop Entry]
 Name=libAfterImage
@@ -45,9 +48,10 @@
 Encoding=UTF-8
 Categories=AfterStepInfo
 TryExec=ASRun
+Name[pl]=Biblioteka libAfterImage
 
 [Desktop Entry]
-Name=AfterStep documentation
+Name=AfterStep Documentation
 Name[af]=Dokumentasie
 Name[am]=ማስረጃ
 Name[ar]=وثائق
@@ -87,7 +91,7 @@
 Name[no]=Dokumentasjon
 Name[nso]=Go dira ditokumente
 Name[pa]=ਦਸਤਾਵੇਜ਼
-Name[pl]=Dokumentacja
+Name[pl]=Dokumentacja Afterstepa
 Name[pt]=Documentação
 Name[pt_BR]=Documentação
 Name[ro]=Documentaţie
@@ -183,9 +187,10 @@
 Encoding=UTF-8
 Categories=AfterStepInfo
 TryExec=ASRun
+Name[pl]=Wpis w Wikipedii
 
 [Desktop Entry]
-Name=AfterWiki - user tips, info
+Name=AfterWiki - User tips, info
 GenericName=URL Link
 Comment=http://wiki.afterstep.org/
 Exec=ASRun --immidiate --cmd http://wiki.afterstep.org/
@@ -195,15 +200,18 @@
 Encoding=UTF-8
 Categories=AfterStepInfo
 TryExec=ASRun
+Name[pl]=AfterWiki - wskazówki, informacje
 
 [Desktop Entry]
-Name=Reported bugs and issues
+Name=Report bugs and issues
 GenericName=URL Link
-Comment=http://bugs.afterprojects.org
-Exec=ASRun --immidiate --cmd http://bugs.afterprojects.org
+Comment=AfterStep SourceForge Bug Tracker
+Exec=ASRun --immidiate --cmd http://sourceforge.net/tracker/?group_id=30&atid=100030
 Icon=normal/Bug
 Terminal=false
 Type=Application
 Encoding=UTF-8
 Categories=AfterStepInfo
 TryExec=ASRun
+Name[pl]=Zgłoszone błędy i problemy
+
--- libAfterImage/afterbase.c	2009-10-14 10:13:28.000000000 -0500
+++ libAfterImage/afterbase.c	2011-12-01 00:05:26.000000000 -0600
@@ -983,7 +983,7 @@
 
 /************************************************************************/
 /************************************************************************/
-/* 	Some usefull implementations 					*/
+/* 	Some useful implementations 					*/
 /************************************************************************/
 ASHashKey asim_pointer_hash_value (ASHashableValue value, ASHashKey hash_size)
 {
--- libAfterConf/afterconf.h	2009-09-30 10:12:04.000000000 -0500
+++ libAfterConf/afterconf.h	2011-12-01 00:14:08.000000000 -0600
@@ -1298,7 +1298,7 @@
 	struct wild_reg_exp **AllowCollides_wrexp ;
 }WinListConfig;
 
-ASModuleConfigClass *WinListConfigClass ;
+ASModuleConfigClass *getWinListConfigClass() ;
 
 #define AS_WINLIST_CONFIG(p) AS_MODULE_CONFIG_TYPED(p,CONFIG_WinList_ID,WinListConfig)
 
--- libAfterImage/afterimage.h	2004-11-10 17:37:25.000000000 -0600
+++ libAfterImage/afterimage.h	2011-12-01 00:05:26.000000000 -0600
@@ -116,7 +116,7 @@
  * Note that XPM can be supported both via built-in code or via libXpm,
  * depending on compilation configuration.
  * Actuall image file format is autodetected from the file contents -
- * file name extention is not used and can be anything at all.
+ * file name extension is not used and can be anything at all.
  *
  * 6. Image export into many popular file formats. Currently implemented :
  * XPM, JPEG, PNG, GIF. Work is underway to implement support for TIFF,
--- libAfterConf/AfterStep.c	2009-09-30 10:12:04.000000000 -0500
+++ libAfterConf/AfterStep.c	2011-12-01 00:05:26.000000000 -0600
@@ -160,7 +160,7 @@
 	"Feel WindowBox definition",
 	"FeelWindowBox",
 	"defines placement policy for certain type of windows, based on desk, window attributes, window size, etc."
-	" Usefull for xinerama configurations, where windows should not be placed in between screens.",
+	" Useful for xinerama configurations, where windows should not be placed in between screens.",
 	NULL,
 	0
 };
--- doc/afterstepdoc.in	2006-08-10 11:48:01.000000000 -0500
+++ doc/afterstepdoc.in	2011-12-01 10:01:01.000000000 -0600
@@ -9,7 +9,7 @@
 # First try standard path, then local, then other possible paths
 #
 
-for app in opera konqueror firefox mozilla netscape; do 
+for app in sensible-browser x-www-browser firefox mozilla opera konqueror netscape; do 
 	full_path=`which $app`
 	if [ "x$full_path" != "x" ] ; then
      		$app @datadir@/afterstep/doc/html/index.html & exit
--- doc/afterstep.xml	2004-07-09 10:57:10.000000000 -0500
+++ doc/afterstep.xml	2011-12-01 00:05:25.000000000 -0600
@@ -573,7 +573,7 @@
       <varlistentry>
       <term><emphasis remap='I'>NoButton number</emphasis> | <emphasis remap='I'>Button number</emphasis></term>
       <listitem>
-<para>Specifing a <emphasis remap='I'>number</emphasis> to each use of <emphasis remap='I'>NoButton</emphasis> will cause that
+<para>Specifying a <emphasis remap='I'>number</emphasis> to each use of <emphasis remap='I'>NoButton</emphasis> will cause that
 buttons number to not be displayed in the title bar. See <emphasis remap='I'>TitleButtons</emphasis>
 above for the <emphasis remap='I'>number</emphasis> and their location on the title bar.  The default
 is to display all buttons defined in the <emphasis remap='I'>look.name</emphasis> file if the
--- src/Animate/Animate.c	2005-09-26 17:45:34.000000000 -0500
+++ src/Animate/Animate.c	2011-12-01 00:14:08.000000000 -0600
@@ -435,7 +435,7 @@
 void CheckConfigSanity()
 {
 	ARGB32 argb = ARGB32_White ;
-	long    pixel = Scr.asv->white_pixel ; 
+	unsigned long    pixel = Scr.asv->white_pixel ;
 	XGCValues gcv;
 
 	if( Config->color ) 
--- libAfterStep/asapp.c	2009-10-05 11:32:59.000000000 -0500
+++ libAfterStep/asapp.c	2011-12-01 00:25:19.000000000 -0600
@@ -682,19 +682,20 @@
 /*********** end command line parsing **************************/
 static char *_as_known_terms[]	= 
 {	
+	"x-terminal-emulator",
 	"urxvt",
 	"aterm",
-	"x-terminal-emulator",
 	"rxvt  -tr -fg yellow -bg black",
-	"eterm -tr -tint blue -fg yellow -bg black",
+	"Eterm -tr -tint blue -fg yellow -bg black",
 	"xterm -fg yellow -bg blue",
 	NULL 
 };
 static char *_as_known_browsers[]	= 
 {
 	"$BROWSER",
-	"firefox",
+	"sensible-browser",
 	"x-www-browser",           /* don't like default debian selection of konqueror */
+	"firefox",
 	"mozilla-firefox",
 	"mozilla",
 	"opera",
--- libAfterStep/asapp.h	2009-02-11 17:32:03.000000000 -0600
+++ libAfterStep/asapp.h	2011-12-01 00:14:08.000000000 -0600
@@ -16,7 +16,7 @@
 #endif
 
 #if defined(__alpha)
-#include "alpha_header.h"
+/*#include "alpha_header.h"*/
 #endif /* NEEDS_ALPHA_HEADER */
 
 /* Some people say that AIX and AIXV3 need 3 preceding underscores, other say
--- libAfterImage/ascmap.h	2004-08-12 17:27:20.000000000 -0500
+++ libAfterImage/ascmap.h	2011-12-01 00:05:26.000000000 -0600
@@ -15,7 +15,7 @@
  * and then approximate remaining colors with the closest colorcell.
  *
  * Since quality of quantization is in reverse proportion to the number
- * of colors in original image, libAfterImage allows to set arbitrary
+ * of colors in original image, libAfterImage allows one to set arbitrary
  * level of downsampling of the color spectrum in the range of 8 bit per
  * channel to 1 bit per channel. Downsampling is performed by simple
  * dropping of less significant bits off of color values.
@@ -26,7 +26,7 @@
  * so : R8G8B8R7G7B7...R1G1B1. That flat index is used to arrange colors
  * in ascending order, and later on to be able to find closest mapped
  * color. Simple hashing technique is used to speed up the
- * sorting/searching, as it allows to limit linked lists traversals.
+ * sorting/searching, as it allows one to limit linked lists traversals.
  *
  * SEE ALSO
  * Structures :
--- libAfterImage/apps/ascompose.c	2009-08-25 16:31:25.000000000 -0500
+++ libAfterImage/apps/ascompose.c	2011-12-01 00:05:26.000000000 -0600
@@ -204,7 +204,7 @@
 		"     --dont-clear    don't clear window before displaying next image\n"
 		" Note that when -I option is used in conjunction with input from\n" 
 		" string or a file - ascompose will endlesly loop through the contents\n"
-		" untill it is killed - usefull for slideshow type of activity.\n"
+		" until it is killed - useful for slideshow type of activity.\n"
 		" When input comes from STDIN, then ascompose will loop untill Ctrl+D\n"
 		" is received (EOF).\n"
 		"\n"
--- libAfterImage/apps/ascompose.man	2002-02-18 01:11:01.000000000 -0600
+++ libAfterImage/apps/ascompose.man	2011-12-01 00:05:26.000000000 -0600
@@ -3,18 +3,15 @@
 .\" ROBODoc (c) 1994-2001 by Frans Slothouber and Jacco van Weert.
 .\" t
 .\" @(#)ascompose.c.3
-.TH ascompose.c 1 "Mon Feb 18 2002" ascompose.c 3
-.PM Generated from ascompose.c with ROBODoc v3.2.3 on Mon Feb 18 01:14:58 2002
+.TH ascompose 1x "Mon Feb 18 2002" ascompose 
+.\" .PM Generated from ascompose.c with ROBODoc v3.2.3 on Mon Feb 18 01:14:58 2002
 
-.SH libAfterImage/ascompose
-.SS\fB NAME\fP 
-.nf
-\fR  \fBascompose\fP is a tool to compose image(s) and display/\fBsave\fP it based on
- supplied XML input file\.
+.SH NAME 
+\fBascompose\fP \- tool to compose image(s) and display/\fBsave\fP it based on supplied XML input file\.
 
 \fP 
 .fi
-.SS\fB SYNOPSIS\fP 
+.SH SYNOPSIS 
 .nf
  \fBascompose\fP \-f file|\-s string [\-o file] [\-t type] [\-V]"
  \fBascompose\fP \-f file|\-s string [\-o file] [\-t type] [\-V]"
@@ -25,7 +22,7 @@
 
 
 .fi
-.SS\fB DESCRIPTION\fP 
+.SH DESCRIPTION 
 .nf
  \fBascompose\fP reads supplied XML data, and manipulates image accordingly\.
  It could transform images from files of any supported file format,
@@ -72,7 +69,7 @@
 
 
 .fi
-.SS\fB OPTIONS\fP 
+.SH OPTIONS 
 .nf
     \-h \-\-help          display help and exit\.
     \-f \-\-file file     an XML file to use as input\.
@@ -91,14 +88,14 @@
                        debug messages\.
 
 .fi
-.SS\fB PORTABILITY\fP 
+.SH PORTABILITY 
 .nf
  \fBascompose\fP could be used both with and without X \fBwindow\fP system\. It has
  been tested on most UNIX flavors on both 32 and 64 bit architecture\.
  It has also been tested under CYGWIN environment on Windows 95/NT/2000
 
 .fi
-.SS\fB USES\fP 
+.SH USES 
 .nf
  \fBlibAfterImage\fP         all the image manipulation routines\.
  libAfterBase          Optionally\. Misc data handling such as hash
@@ -110,7 +107,7 @@
  libTIFF               TIFF image format support\.
 
 .fi
-.SS\fB AUTHOR\fP 
+.SH AUTHOR 
 .nf
 \fB  Ethan Fisher          <allanon at crystaltokyo dot com>
  Sasha Vasko           <sasha at aftercode dot net>
@@ -120,13 +117,13 @@
 
 .PP
 .SH libAfterImage/ascompose/sample
-.SS\fB EXAMPLE\fP 
+.SH EXAMPLE 
 .nf
  Here is the default script that gets executed by \fBascompose\fP, if no
  parameters are given :
 
 .fi
-.SS\fB SOURCE\fP 
+.SH SOURCE 
 .nf
     static char* default_doc_str = "\\
     <\fBcomposite\fP op=hue>\\
--- libAfterImage/apps/asflip.c	2009-02-11 17:32:03.000000000 -0600
+++ libAfterImage/apps/asflip.c	2011-12-01 00:05:26.000000000 -0600
@@ -199,7 +199,7 @@
  * Step 2. Flipping ASImage.
  * DESCRIPTION
  * Flipping can actually be combined with offset and tiling. Original
- * image gets tiled to suplied rectangle, and then gets rotated to
+ * image gets tiled to supplied rectangle, and then gets rotated to
  * requested degree.
  * EXAMPLE
  *  	flipped_im = flip_asimage(asv, im,
--- libAfterImage/asfont.h	2008-08-15 16:47:37.000000000 -0500
+++ libAfterImage/asfont.h	2011-12-01 00:05:26.000000000 -0600
@@ -330,7 +330,7 @@
  * fontman  - pointer to valid ASFontManager object to be deallocated.
  * reusable - If True, then memory holding object itself will not be
  *            freed - only resources will be deallocated. That is
- *            usefull for structures created on stack.
+ *            useful for structures created on stack.
  * DESCRIPTION
  * destroy_font_manager() closes all the fonts open with this
  * ASFontManager. It will also close connection to FreeType library, and
@@ -365,8 +365,8 @@
  * open_freetype_font() will attempt to find font file in any of the
  * directories specified in ASFontManager's font_path. If it fails to do
  * so - then it will check if filename has alldigit extentions. It will
- * then try to interpret that extention as a face number, and try and
- * find the file with extention stripped off.
+ * then try to interpret that extension as a face number, and try and
+ * find the file with extension stripped off.
  * If file was found function will atempt to read it using FreeType
  * library. If requested face is not available in the font - face 0 will
  * be used.
--- libAfterImage/apps/asgrad.c	2009-02-11 17:32:03.000000000 -0600
+++ libAfterImage/apps/asgrad.c	2011-12-01 00:05:26.000000000 -0600
@@ -247,7 +247,7 @@
  * All that is needed to draw gradient is to call make_gradient(),
  * passing pointer to ASGradient structure, that describes gradient.
  * Naturally size of the gradient is needed too. Another parameter is
- * filter - that is a bit mask that allows to draw gradient using only a
+ * filter - that is a bit mask that allows one to draw gradient using only a
  * subset of the channels, represented by set bits. SCL_DO_ALL means
  * that all 4 channels must be rendered.
  * make_gradient() creates ASImage of requested size and fills it with
--- libASGTK/asgtklookedit.c	2009-07-20 16:24:27.000000000 -0500
+++ libASGTK/asgtklookedit.c	2011-12-01 00:14:08.000000000 -0600
@@ -29,6 +29,7 @@
 #include "../libAfterStep/parser.h"
 #include "../libAfterStep/freestor.h"
 #include "../libAfterStep/mystyle.h"
+#include "../libAfterStep/session.h"
 #include "../libAfterConf/afterconf.h"
 
 #include <unistd.h>		   
@@ -659,7 +660,7 @@
 		filename = make_session_data_file  (Session, False, 0, MYSTYLES_DIR, msd->Name, NULL );
 		if (filename)
 		{
-			FreeStorageElem *fs = MyStyleDefinitionsList2free_storage (&LookSyntax, msd);
+			FreeStorageElem *fs = MyStyleDefinitionsList2free_storage (msd, &LookSyntax);
 			if (fs)
 			{
 				WriteFreeStorageToFile (filename, "afterstep", &MyStyleSyntax, fs->sub, 0);
@@ -817,7 +818,8 @@
 	if( self->config != NULL ) 
 	{
 		MyStyleDefs2MyStylesPanel( NULL, self->mystyles );	
- 		DestroyLookConfig (&(self->config));
+ 		DestroyLookConfig (self->config);
+		self->config = NULL;
 	}
 
 	if( self->configfilename != NULL ) 
--- libASGTK/asgtkxmleditor.c	2007-01-02 18:23:37.000000000 -0600
+++ libASGTK/asgtkxmleditor.c	2011-12-01 00:05:25.000000000 -0600
@@ -535,7 +535,7 @@
 	"slices image to arbitrary size leaving corners unchanged.\n"
 	"Contents of the image between x_start and x_end will be tiled horizontally. "
 	"Contents of the image between y_start and y_end will be tiled vertically. "
-	"This is usefull to get background images to fit the size of the text or a widget, while preserving its borders undistorted, "
+	"This is useful to get background images to fit the size of the text or a widget, while preserving its borders undistorted, "
 	"which is the usuall result of simple scaling.\n"
 	"If you want to keep image proportions while resizing-use \"proportional\" instead of specific size for particular dimention."
 ,
--- libAfterImage/asim_afterbase.h	2009-10-14 10:13:28.000000000 -0500
+++ libAfterImage/asim_afterbase.h	2011-12-01 00:05:26.000000000 -0600
@@ -141,7 +141,7 @@
  * Please submit a bug report if usage of any of the following generates errors on
  * your compiler . Thanks!!! */
 
-/* Some usefull debugging macros : */
+/* Some useful debugging macros : */
 #ifdef __GNUC__
 
 #if (!defined(NO_DEBUG_OUTPUT))&&(defined(LOCAL_DEBUG)||defined(DEBUG)||defined(DEBUG_ALL))
--- libAfterImage/asimage.h	2008-05-29 17:23:25.000000000 -0500
+++ libAfterImage/asimage.h	2011-12-01 00:05:26.000000000 -0600
@@ -226,7 +226,7 @@
 /* Auxiliary data structures : */
 /****s* libAfterImage/ASVectorPalette
  * NAME
- * ASVectorPalette contains pallette allowing us to map double values 
+ * ASVectorPalette contains palette allowing us to map double values
  * in vector image data into actuall ARGB values.
  * SOURCE
  */
@@ -277,7 +277,7 @@
  * array3: [layer6(next==NULL)][layer7(next==layer7)]
  *                                ^______|
  *
- * While iterating throught such a list we check for two conditions -
+ * While iterating through such a list we check for two conditions -
  * exceeding count of layers and layer pointing to self. When any of
  * that is met - we stopping iteration.
  * SEE ALSO
@@ -640,7 +640,7 @@
  * INPUTS
  * imman           - pointer to ASImageManager object to be deallocated
  * reusable        - if True, then memory that holds object itself will
- *                   not be deallocated. Usefull when object is created
+ *                   not be deallocated. Useful when object is created
  *                   on stack.
  * DESCRIPTION
  * Destroys all the referenced images, PATH values and if reusable is False,
@@ -990,7 +990,7 @@
  * DESCRIPTION
  * asimage_print_line() prints data stored in specified image scanline
  * channel. That may include simple summary of how much memory is used,
- * actual visible data, and/or RLE control codes. That helps to see
+ * actual visible data, and/or RLE control codes. That helps one to see
  * how effectively data is encoded.
  *
  * Useful mostly for debugging purposes.
@@ -1102,9 +1102,9 @@
  * rects_count_ret - returns count of generated rectangles.
  * DESCRIPTION
  * This function will translate contents of selected channel 
- * (usualy alpha) into a list of rectangles, ecompasing regions 
- * with values above the threshold. This is usefull to generate shape
- * of the window to be used with X Shape extention.
+ * (usually alpha) into a list of rectangles, ecompasing regions
+ * with values above the threshold. This is useful to generate shape
+ * of the window to be used with X Shape extension.
  *********/
 XRectangle*
 get_asimage_channel_rects( ASImage *src, int channel, unsigned int threshold, unsigned int *rects_count_ret );
--- libAfterImage/apps/asscale.c	2009-02-11 17:32:03.000000000 -0600
+++ libAfterImage/apps/asscale.c	2011-12-01 00:05:26.000000000 -0600
@@ -206,7 +206,7 @@
  * ASImage will not have any data in its buffers, but it will have
  * ximage member set to point to valid XImage. Subsequently we enjoy
  * that convenience, by setting use_cached to True in call to
- * asimage2pixmap. That ought to save us alot of processing.
+ * asimage2pixmap. That ought to save us a lot of processing.
  *
  * Scaling algorithm is rather sophisticated and is implementing 4 point
  * interpolation. Which basically means that we try to approximate each
--- libAfterImage/apps/astext.c	2009-02-11 17:32:03.000000000 -0600
+++ libAfterImage/apps/astext.c	2011-12-01 00:05:26.000000000 -0600
@@ -394,7 +394,7 @@
  * SYNOPSIS
  * Step 2. Approximating rendered text size.
  * DESCRIPTION
- * Prior to actually drawing the text it is usefull to estimate the size
+ * Prior to actually drawing the text it is useful to estimate the size
  * of the image, that rendered text will occupy, So that window can be
  * created of appropriate size, and othe interface elements laid out
  * accordingly. get_text_size() could be used to obtain rendered text
--- libAfterImage/apps/astile.c	2009-02-11 17:32:03.000000000 -0600
+++ libAfterImage/apps/astile.c	2011-12-01 00:05:26.000000000 -0600
@@ -245,7 +245,7 @@
  * As the result obtained ASImage will not have any data in its buffers,
  * but it will have ximage member set to point to valid XImage.
  * Subsequently we enjoy that convinience, by setting use_cached to True
- * in call to asimage2pixmap(). That ought to save us alot of processing.
+ * in call to asimage2pixmap(). That ought to save us a lot of processing.
  *
  * Tinting works in both directions - it can increase intensity of the
  * color or decrease it. If any particular channel of the tint_color is
--- libAfterImage/apps/asview.c	2009-02-11 17:32:03.000000000 -0600
+++ libAfterImage/apps/asview.c	2011-12-01 00:05:26.000000000 -0600
@@ -233,7 +233,7 @@
  * Step 3. Preparation of the visual.
  * DESCRIPTION
  * At this point we have to obtain Visual information, as window
- * creation is highly dependant on Visual being used. In fact when X
+ * creation is highly dependent on Visual being used. In fact when X
  * creates a window it ties it to a particular Visual, and all its
  * attributes, such as colormap, pixel values, pixmaps, etc. must be
  * associated with the same Visual. Accordingly we need to acquire
--- libAfterImage/asvisual.h	2008-05-29 17:23:25.000000000 -0500
+++ libAfterImage/asvisual.h	2011-12-01 00:05:26.000000000 -0600
@@ -340,7 +340,7 @@
  * screen   	- screen number on which to query visuals.
  * root     	- root window on that screen.
  * default_depth- default colordepth of the screen.
- * visual_id    - optional ID of prefered Visual.
+ * visual_id    - optional ID of preferred Visual.
  * cmap         - optional colormap to be used.
  * RETURN VALUE
  * True on success, False on failure
@@ -433,7 +433,7 @@
  * structure, but instead will use supplied one. Useful for allocating
  * ASVisual on stack.
  * This particular function will not do any autodetection and will use
- * Visual ID supplied. That is usefull when libAfterImage is used with
+ * Visual ID supplied. That is useful when libAfterImage is used with
  * an app that has its own approach to Visual handling, and since Visuals
  * on all Windows, Pixmaps and colormaps must match, there is a need to
  * synchronise visuals used by an app and libAfterImage.
--- libAfterBase/audit.c	2009-12-11 16:38:48.000000000 -0600
+++ libAfterBase/audit.c	2011-12-01 00:05:26.000000000 -0600
@@ -594,7 +594,7 @@
 		m = curr_hash_data( &i );
 		if( m == NULL )
 		{
-            fprintf (stream, "hmm, wierd, encoutered NULL pointer while trying to check allocation record for %p!", (void*)((*(i.curr_item))->value));
+            fprintf (stream, "hmm, weird, encoutered NULL pointer while trying to check allocation record for %p!", (void*)((*(i.curr_item))->value));
 			continue;
 		}else if (m->freed == 0)
 		{
--- libAfterImage/blender.c	2008-05-29 17:23:25.000000000 -0500
+++ libAfterImage/blender.c	2011-12-01 00:05:26.000000000 -0600
@@ -319,9 +319,9 @@
   { "dissipate", 9, dissipate_scanlines, "randomly alpha-blend images"},
   { "hue", 3, hue_scanlines, "hue bottom image same as top image"  },
   { "lighten", 7, lighten_scanlines, "use highest color value from both images" },
-  { "overlay", 7, overlay_scanlines, "some wierd image overlaying(see GIMP)" },
+  { "overlay", 7, overlay_scanlines, "some weird image overlaying(see GIMP)" },
   { "saturate", 8, saturate_scanlines, "saturate bottom image same as top image"},
-  { "screen", 6, screen_scanlines, "another wierd image overlaying(see GIMP)" },
+  { "screen", 6, screen_scanlines, "another weird image overlaying(see GIMP)" },
   { "sub", 3, sub_scanlines, "color substraction with saturation" },
   { "tint", 4, tint_scanlines, "tinting image with image" },
   { "value", 5, value_scanlines, "value bottom image same as top image" },
--- libAfterImage/blender.h	2005-04-04 11:52:21.000000000 -0500
+++ libAfterImage/blender.h	2011-12-01 00:05:26.000000000 -0600
@@ -28,7 +28,7 @@
  *          saturate_scanlines(), value_scanlines(),
  *          colorize_scanlines(), dissipate_scanlines().
  *
- *    usefull merging function name to function translator :
+ *    useful merging function name to function translator :
  *          blend_scanlines_name2func()
  *
  * Other libAfterImage modules :
@@ -197,9 +197,9 @@
  *                        value of top and bottom :
  *                        bottom = (bottom>top)?bottom:top;
  * NAME
- * screen_scanlines()   - some wierd merging algorithm taken from GIMP;
+ * screen_scanlines()   - some weird merging algorithm taken from GIMP;
  * NAME
- * overlay_scanlines()  - some wierd merging algorithm taken from GIMP;
+ * overlay_scanlines()  - some weird merging algorithm taken from GIMP;
  * NAME
  * hue_scanlines()      - substitute hue of bottom scanline with hue of
  *                        top scanline;
--- libAfterImage/bmp.c	2007-12-27 12:58:38.000000000 -0600
+++ libAfterImage/bmp.c	2011-01-28 12:52:42.000000000 -0600
@@ -34,8 +34,14 @@
 
 #include "asimage.h"
 #include "imencdec.h"
+#include "import.h"
+#include "export.h"
 #include "bmp.h"
 
+/* from import.c : */
+FILE* open_image_file( const char *path );
+/* from export.c : */
+FILE* open_writeable_image_file( const char *path );
 
 void 
 dib_data_to_scanline( ASScanline *buf, 
@@ -305,3 +311,358 @@
 	return im;
 }
 
+static size_t
+bmp_write32 (FILE *fp, CARD32 *data, int count)
+{
+  	size_t total = count;
+	if( count > 0 )
+	{
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		CARD8 *raw = (CARD8*)data ;
+#endif
+		count = 0 ;
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		while( count < total )
+		{
+			data[count] = (raw[0]<<24)|(raw[1]<<16)|(raw[2]<<8)|raw[3];
+			++count ;
+			raw += 4 ;
+		}
+#endif
+		total = fwrite((char*) data, sizeof (CARD8), total<<2, fp)>>2;
+	}
+	return total;
+}
+
+static size_t
+bmp_write16 (FILE *fp, CARD16 *data, int count)
+{
+  	size_t total = count;
+	if( count > 0 )
+	{
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		CARD8 *raw = (CARD8*)data ;
+#endif
+		count = 0 ;
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		while( count < total )
+		{
+			data[count] = (raw[0]<<16)|raw[1];
+			++count ;
+			raw += 2 ;
+		}
+#endif
+		total = fwrite((char*) data, sizeof (CARD8), total<<1, fp)>>1;
+	}
+	return total;
+}
+
+Bool
+ASImage2bmp ( ASImage *im, const char *path,  ASImageExportParams *params )
+{
+	Bool success = False;
+	FILE *outfile = NULL ;
+	START_TIME(started);
+
+	if ((outfile = open_writeable_image_file( path )) != NULL)
+	{
+		void *bmbits ;
+		BITMAPINFO *bmi = ASImage2DBI( get_default_asvisual(), im, 0, 0, im->width, im->height, &bmbits, 0 );
+		if( bmi != NULL && bmbits != NULL ) 
+		{
+			BITMAPFILEHEADER bmh ;
+			int bits_size = (((bmi->bmiHeader.biWidth*3+3)/4)*4)*bmi->bmiHeader.biHeight;          /* DWORD aligned */
+
+			bmh.bfType = BMP_SIGNATURE;
+		    bmh.bfSize = 14+bmi->bmiHeader.biSize+bits_size; /* Specifies the size, in bytes, of the bitmap file */
+		    bmh.bfReserved1 = 0;
+			bmh.bfReserved2 = 0;
+		    bmh.bfOffBits = 14+bmi->bmiHeader.biSize; /* Specifies the offset, in bytes, 
+							   * from the BITMAPFILEHEADER structure to the bitmap bits */
+			/* writing off the header */
+			bmp_write16( outfile, &bmh.bfType, 1 );
+			bmp_write32( outfile, &bmh.bfSize, 3 );
+			/* writing off the bitmapinfo : */
+			bmp_write32( outfile, &bmi->bmiHeader.biSize, 1 );
+			bmp_write32( outfile, (CARD32*)&bmi->bmiHeader.biWidth, 2 );
+			bmp_write16( outfile, &bmi->bmiHeader.biPlanes, 2 );
+			/* bmi->bmiHeader.biCompression = 0 ; */
+			bmp_write32( outfile, &bmi->bmiHeader.biCompression, 6 );
+
+			/* writing off the bitmapbits */
+			if (fwrite( bmbits, sizeof(CARD8), bits_size, outfile ) == bits_size)
+				success = True;
+				
+			free( bmbits );
+			free( bmi );
+			
+		}
+		if (outfile != stdout)
+			fclose(outfile);
+	}
+	SHOW_TIME("image export",started);
+	return success;
+}
+
+/***********************************************************************************/
+/* Windows BMP file format :   									   				   */
+static size_t
+bmp_read32 (FILE *fp, CARD32 *data, int count)
+{
+  	size_t total = count;
+	if( count > 0 )
+	{
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		CARD8 *raw = (CARD8*)data ;
+#endif
+		total = fread((char*) data, sizeof (CARD8), count<<2, fp)>>2;
+		count = 0 ;
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		while( count < total )
+		{
+			data[count] = (raw[0]<<24)|(raw[1]<<16)|(raw[2]<<8)|raw[3];
+			++count ;
+			raw += 4 ;
+		}
+#endif
+	}
+	return total;
+}
+
+static size_t
+bmp_read16 (FILE *fp, CARD16 *data, int count)
+{
+  	size_t total = count;
+	if( count > 0 )
+	{
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		CARD8 *raw = (CARD8*)data ;
+#endif
+		total = fread((char*) data, sizeof (CARD8), count<<1, fp)>>1;
+		count = 0 ;
+#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
+		while( count < total )
+		{
+			data[count] = (raw[0]<<16)|raw[1];
+			++count ;
+			raw += 2 ;
+		}
+#endif
+	}
+	return total;
+}
+
+
+ASImage *
+read_bmp_image( FILE *infile, size_t data_offset, BITMAPINFOHEADER *bmp_info,
+				ASScanline *buf, CARD8 *gamma_table,
+				unsigned int width, unsigned int height,
+				Bool add_colormap, unsigned int compression )
+{
+	Bool success = False ;
+	CARD8 *cmap = NULL ;
+	int cmap_entries = 0, cmap_entry_size = 4, row_size ;
+	int y;
+	ASImage *im = NULL ;
+	CARD8 *data ;
+	int direction = -1 ;
+
+	if( bmp_read32( infile, &bmp_info->biSize, 1 ) )
+	{
+		if( bmp_info->biSize == 40 )
+		{/* long header */
+			bmp_read32( infile, (CARD32*)&bmp_info->biWidth, 2 );
+			bmp_read16( infile, &bmp_info->biPlanes, 2 );
+			bmp_info->biCompression = 1 ;
+			success = (bmp_read32( infile, &bmp_info->biCompression, 6 )==6);
+		}else
+		{
+			CARD16 dumm[2] ;
+			bmp_read16( infile, &dumm[0], 2 );
+			bmp_info->biWidth = dumm[0] ;
+			bmp_info->biHeight = dumm[1] ;
+			success = ( bmp_read16( infile, &bmp_info->biPlanes, 2 ) == 2 );
+			bmp_info->biCompression = 0 ;
+		}
+	}
+#ifdef LOCAL_DEBUG
+	fprintf( stderr, "bmp.info.biSize = %ld(0x%lX)\n", bmp_info->biSize, bmp_info->biSize );
+	fprintf( stderr, "bmp.info.biWidth = %ld\nbmp.info.biHeight = %ld\n",  bmp_info->biWidth,  bmp_info->biHeight );
+	fprintf( stderr, "bmp.info.biPlanes = %d\nbmp.info.biBitCount = %d\n", bmp_info->biPlanes, bmp_info->biBitCount );
+	fprintf( stderr, "bmp.info.biCompression = %ld\n", bmp_info->biCompression );
+	fprintf( stderr, "bmp.info.biSizeImage = %ld\n", bmp_info->biSizeImage );
+#endif
+	if( ((int)(bmp_info->biHeight)) < 0 )
+		direction = 1 ;
+	if( height == 0 )
+		height  = direction == 1 ? -((long)(bmp_info->biHeight)):bmp_info->biHeight ;
+	if( width == 0 )
+		width = bmp_info->biWidth ;
+
+	if( !success || bmp_info->biCompression != 0 ||
+		width > MAX_IMPORT_IMAGE_SIZE ||
+		height > MAX_IMPORT_IMAGE_SIZE )
+	{
+		return NULL;
+	}
+	if( bmp_info->biBitCount < 16 )
+		cmap_entries = 0x01<<bmp_info->biBitCount ;
+
+	if( bmp_info->biSize != 40 )
+		cmap_entry_size = 3;
+	if( cmap_entries )
+	{
+		cmap = safemalloc( cmap_entries * cmap_entry_size );
+		fread(cmap, sizeof (CARD8), cmap_entries * cmap_entry_size, infile);
+	}
+
+	if( add_colormap )
+		data_offset += cmap_entries*cmap_entry_size ;
+
+	fseek( infile, data_offset, SEEK_SET );
+	row_size = (width*bmp_info->biBitCount)>>3 ;
+	if( row_size == 0 )
+		row_size = 1 ;
+	else
+		row_size = (row_size+3)/4 ;            /* everything is aligned by 32 bits */
+	row_size *= 4 ;                            /* in bytes  */
+	data = safemalloc( row_size );
+
+	im = create_asimage( width,  height, compression );
+	/* Window BMP files are little endian  - we need to swap Red and Blue */
+	prepare_scanline( im->width, 0, buf, True );
+
+	y =( direction == 1 )?0:height-1 ;
+	while( y >= 0 && y < (int)height)
+	{
+		if( fread( data, sizeof (char), row_size, infile ) < (unsigned int)row_size )
+			break;
+ 		dib_data_to_scanline(buf, bmp_info, gamma_table, data, cmap, cmap_entry_size); 
+		asimage_add_line (im, IC_RED,   buf->red  , y);
+		asimage_add_line (im, IC_GREEN, buf->green, y);
+		asimage_add_line (im, IC_BLUE,  buf->blue , y);
+		y += direction ;
+	}
+	free( data );
+	if( cmap )
+		free( cmap );
+	return im ;
+}
+
+ASImage *
+bmp2ASImage( const char * path, ASImageImportParams *params )
+{
+	ASImage *im = NULL ;
+	/* More stuff */
+	FILE         *infile;					   /* source file */
+	ASScanline    buf;
+	BITMAPFILEHEADER  bmp_header ;
+	BITMAPINFOHEADER  bmp_info;
+	START_TIME(started);
+
+
+	if ((infile = open_image_file(path)) == NULL)
+		return NULL;
+
+	bmp_header.bfType = 0 ;
+	if( bmp_read16( infile, &bmp_header.bfType, 1 ) )
+		if( bmp_header.bfType == BMP_SIGNATURE )
+			if( bmp_read32( infile, &bmp_header.bfSize, 3 ) == 3 )
+				im = read_bmp_image( infile, bmp_header.bfOffBits, &bmp_info, &buf, params->gamma_table, 0, 0, False, params->compression );
+#ifdef LOCAL_DEBUG
+	fprintf( stderr, "bmp.header.bfType = 0x%X\nbmp.header.bfSize = %ld\nbmp.header.bfOffBits = %ld(0x%lX)\n",
+					  bmp_header.bfType, bmp_header.bfSize, bmp_header.bfOffBits, bmp_header.bfOffBits );
+#endif
+	if( im != NULL )
+		free_scanline( &buf, True );
+	else
+		show_error( "invalid or unsupported BMP format in image file \"%s\"", path );
+
+	fclose( infile );
+	SHOW_TIME("image loading",started);
+	return im ;
+}
+
+/***********************************************************************************/
+/* Windows ICO/CUR file format :   									   			   */
+
+ASImage *
+ico2ASImage( const char * path, ASImageImportParams *params )
+{
+	ASImage *im = NULL ;
+	/* More stuff */
+	FILE         *infile;					   /* source file */
+	ASScanline    buf;
+	int y, mask_bytes;
+    CARD8  *and_mask;
+	START_TIME(started);
+	struct IconDirectoryEntry {
+    	CARD8  bWidth;
+    	CARD8  bHeight;
+    	CARD8  bColorCount;
+    	CARD8  bReserved;
+    	CARD16  wPlanes;
+    	CARD16  wBitCount;
+    	CARD32 dwBytesInRes;
+    	CARD32 dwImageOffset;
+	};
+	struct ICONDIR {
+    	CARD16          idReserved;
+    	CARD16          idType;
+    	CARD16          idCount;
+	} icon_dir;
+   	struct IconDirectoryEntry  icon;
+	BITMAPINFOHEADER bmp_info;
+
+	if ((infile = open_image_file(path)) == NULL)
+		return NULL;
+
+	icon_dir.idType = 0 ;
+	if( bmp_read16( infile, &icon_dir.idReserved, 3 ) == 3)
+		if( icon_dir.idType == 1 || icon_dir.idType == 2)
+		{
+			fread( &(icon.bWidth), sizeof(CARD8),4,infile );
+			bmp_read16( infile, &(icon.wPlanes), 2 );
+			if( bmp_read32( infile, &(icon.dwBytesInRes), 2 ) == 2 )
+			{
+				fseek( infile, icon.dwImageOffset, SEEK_SET );
+				im = read_bmp_image( infile, icon.dwImageOffset+40+(icon.bColorCount*4), &bmp_info, &buf, params->gamma_table,
+					                 icon.bWidth, icon.bHeight, (icon.bColorCount==0), params->compression );
+			}
+		}
+#ifdef LOCAL_DEBUG
+	fprintf( stderr, "icon.dir.idType = 0x%X\nicon.dir.idCount = %d\n",  icon_dir.idType, icon_dir.idCount );
+	fprintf( stderr, "icon[1].bWidth = %d(0x%X)\n",  icon.bWidth,  icon.bWidth );
+	fprintf( stderr, "icon[1].bHeight = %d(0x%X)\n",  icon.bHeight,  icon.bHeight );
+	fprintf( stderr, "icon[1].bColorCount = %d\n",  icon.bColorCount );
+	fprintf( stderr, "icon[1].dwImageOffset = %ld(0x%lX)\n",  icon.dwImageOffset,  icon.dwImageOffset );
+    fprintf( stderr, "icon[1].bmp_size = %ld\n",  icon.dwBytesInRes );
+    fprintf( stderr, "icon[1].dwBytesInRes = %ld\n",  icon.dwBytesInRes );
+#endif
+	if( im != NULL )
+	{
+        mask_bytes = ((icon.bWidth>>3)+3)/4 ;    /* everything is aligned by 32 bits */
+        mask_bytes *= 4 ;                      /* in bytes  */
+        and_mask = safemalloc( mask_bytes );
+        for( y = icon.bHeight-1 ; y >= 0 ; y-- )
+		{
+			int x ;
+            if( fread( and_mask, sizeof (CARD8), mask_bytes, infile ) < (unsigned int)mask_bytes )
+				break;
+			for( x = 0 ; x < icon.bWidth ; ++x )
+            {
+				buf.alpha[x] = (and_mask[x>>3]&(0x80>>(x&0x7)))? 0x0000 : 0x00FF ;
+            }
+			im->channels[IC_ALPHA][y]  = store_data( NULL, (CARD8*)buf.alpha, im->width*4, 
+													 ASStorage_32BitRLE|ASStorage_Bitmap, 0);
+		}
+        free( and_mask );
+		free_scanline( &buf, True );
+	}else
+		show_error( "invalid or unsupported ICO format in image file \"%s\"", path );
+
+	fclose( infile );
+	SHOW_TIME("image loading",started);
+	return im ;
+}
+
--- libAfterImage/char2uni.h	2004-08-12 17:27:20.000000000 -0500
+++ libAfterImage/char2uni.h	2011-12-01 00:05:26.000000000 -0600
@@ -59,7 +59,7 @@
 
 /****d* libAfterImage/CHAR_SIZE
  * NAME 
- * CHAR_SIZE - Convinient macro so we can transparently determine the 
+ * CHAR_SIZE - Convenient macro so we can transparently determine the
  * number of bytes that character spans. It assumes UTF-8 encoding when 
  * I18N is enabled.
  * SOURCE
--- libAfterImage/win32/config.h	2009-03-18 12:20:58.000000000 -0500
+++ libAfterImage/win32/config.h	2011-01-28 12:53:39.000000000 -0600
@@ -1,5 +1,6 @@
 /* config.h.in.  Generated from configure.in by autoheader.  */
-
+#ifndef WIN32_CONFIG_H
+#define WIN32_CONFIG_H
 /* Define if memory allocation logging and debugging is desired */
 #undef DEBUG_ALLOCS
 
@@ -176,3 +177,5 @@
 /* Define as `__inline' if that's what the C compiler calls it, or to nothing
    if it is not supported. */
 #define inline
+
+#endif
\ No newline at end of file
--- libAfterImage/config.h.in	2006-11-07 11:43:13.000000000 -0600
+++ libAfterImage/config.h.in	2011-12-01 00:05:26.000000000 -0600
@@ -34,7 +34,7 @@
 /* Define if libgif/ungif is available */
 #undef HAVE_GIF
 
-/* Support for OpenGL extention */
+/* Support for OpenGL extension */
 #undef HAVE_GLX
 
 /* Define to 1 if you have the <inttypes.h> header file. */
--- src/afterstep/configure.c	2009-12-23 13:21:40.000000000 -0600
+++ src/afterstep/configure.c	2011-12-01 00:14:08.000000000 -0600
@@ -255,8 +255,8 @@
 static MyFrameDefinition *MyFrameList = NULL ;
 static MyFrameDefinition *LegacyFrameDef = NULL ;
 
-static balloonConfig BalloonConfig = {0, 0, 0, 0, 0, 0, 0, NULL, 0, 0 };
-static balloonConfig MenuBalloonConfig = {0, 0, 0, 0, 0, 0, 0, NULL, 0, 0 };
+static balloonConfig BalloonConfig = {0, 0, 0, 0, 0, 0, 0, 0, NULL, 0, 0 };
+static balloonConfig MenuBalloonConfig = {0, 0, 0, 0, 0, 0, 0, 0, NULL, 0, 0 };
 
 static char         *MSWindowName[BACK_STYLES] = {NULL};
 static char         *MSMenuName[MENU_BACK_STYLES] = {NULL };
@@ -1779,8 +1779,8 @@
                     display_progress( True, "WORKSPACE STATE configuration loaded from \"%s\".", ws_file);
 				}else
                 {    
-                    show_progress("WORKSPACE STATE file cannot be not found!");
-                    display_progress( True, "WORKSPACE STATE file cannot be not found!");
+                    show_progress("WORKSPACE STATE file cannot be found!");
+                    display_progress( True, "WORKSPACE STATE file cannot be found!");
                 }
 				merge_feel( &Scr.Feel, &TmpFeel );
             }else
--- configure	2011-01-13 13:27:10.000000000 -0600
+++ configure	2011-12-01 00:05:25.000000000 -0600
@@ -871,9 +871,9 @@
   --enable-fixeditems     enable fixed menu entries [no]
   --enable-ascp           build AfterStep Control Panel [yes]
   --enable-shaping        support shaped windows [yes]
-  --enable-shmimage       support shared memory images [yes]
-  --enable-xinerama       support Xinerama Multihead extentions [yes]
-  --enable-glx            support for OpenGL extention [yes]
+  --enable-shmimage       enable usage of MIT shared memory extension for image transfer no
+  --enable-shaping        enable usage of MIT shaped windows extension yes
+  --enable-glx            enable usage of GLX extension no
   --enable-staticlibs     enable linking to libafterstep statically [yes]
   --enable-sharedlibs     enable linking to libafterstep dynamically [no]
   --enable-gdb            add gdb symbols (-g) (for debugging) [no]
--- libAfterImage/configure.in	2011-01-13 13:27:11.000000000 -0600
+++ libAfterImage/configure.in	2011-12-01 00:05:26.000000000 -0600
@@ -35,9 +35,9 @@
 AC_ARG_ENABLE(warn,			[  --enable-warn            turn on more compiler warnings (for debugging) [no] ],enable_warn=$enableval,enable_warn="no")
 AC_ARG_ENABLE(gprof,		[  --enable-gprof           add gprof symbols (-pg) (for debugging) [no] ],enable_gprof=$enableval,enable_gprof="no")
 AC_ARG_ENABLE(audit,		[  --enable-audit           memory usage audit (for debugging) [no] ],enable_audit=$enableval,enable_audit="no")
-AC_ARG_ENABLE(shmimage,		[  --enable-shmimage        enable usage of MIT shared memory extention for image transfer [no] ],enable_shmimage=$enableval,enable_shmimage="no")
-AC_ARG_ENABLE(shaping,		[  --enable-shaping        enable usage of MIT shaped windows extention [yes] ],enable_shaping=$enableval,enable_shaping="yes")
-AC_ARG_ENABLE(glx,		[  --enable-glx            enable usage of GLX extention [no] ],enable_glx=$enableval,enable_glx="no")
+AC_ARG_ENABLE(shmimage,		[  --enable-shmimage        enable usage of MIT shared memory extension for image transfer [no] ],enable_shmimage=$enableval,enable_shmimage="no")
+AC_ARG_ENABLE(shaping,		[  --enable-shaping        enable usage of MIT shaped windows extension [yes] ],enable_shaping=$enableval,enable_shaping="yes")
+AC_ARG_ENABLE(glx,		[  --enable-glx            enable usage of GLX extension [no] ],enable_glx=$enableval,enable_glx="no")
 
 AC_ARG_ENABLE(mmx_optimization,
 							[  --enable-mmx-optimization  enable utilization of MMX instruction set to speed up imaging operations [yes] ],enable_mmx_optimization=$enableval,enable_mmx_optimization="yes")
@@ -313,7 +313,7 @@
 fi
 
 if test "x$enable_glx" = "xyes"; then
-  	AC_CHECK_LIB(GL, glDrawPixels, [x_libs="$x_libs -lGL";AC_DEFINE(HAVE_GLX,1,Support for OpenGL extention)],,$full_x_libs)
+  	AC_CHECK_LIB(GL, glDrawPixels, [x_libs="$x_libs -lGL";AC_DEFINE(HAVE_GLX,1,Support for OpenGL extension)],,$full_x_libs)
 fi
 
 
--- afterstep/database	2007-07-21 21:29:55.000000000 -0500
+++ afterstep/database	2011-12-01 11:01:12.000000000 -0600
@@ -74,6 +74,8 @@
 # , StartsOnDesk 1
 Style	"Netscape"		Icon netscape.xpm, IgnoreConfig	
 # , StartsOnDesk 1
+Style	"Iceape-bin"		IgnoreConfig
+Style	"Iceweasel"		IgnoreConfig
 
 # Email apps
 #Style	"Thunderbird-bin"	StartsOnDesk 2
--- libAfterStep/desktop_category.c	2007-03-08 17:33:15.000000000 -0600
+++ libAfterStep/desktop_category.c	2011-12-05 15:43:23.000000000 -0600
@@ -492,7 +492,7 @@
 	if( *trg ) 	free( *trg ); \
 	if( de->val##_localized ) \
 	{	*trg = mystrdup (de->val##_localized); \
-		if( get_flags( de->flags, ASDE_EncodingUTF8) ) 	return True; \
+		if( ! get_flags( de->flags, ASDE_EncodingNonUTF8) ) 	return True; \
 	}else	*trg = mystrdup (de->val); \
   }return False; \
 }
--- libAfterStep/desktop_category.h	2006-12-08 14:01:54.000000000 -0600
+++ libAfterStep/desktop_category.h	2011-12-05 15:43:23.000000000 -0600
@@ -26,7 +26,7 @@
 #define ASDE_Hidden				(0x01<<1)	  
 #define ASDE_Terminal			(0x01<<2)	  
 #define ASDE_StartupNotify		(0x01<<3)	  
-#define ASDE_EncodingUTF8		(0x01<<4)	  
+#define ASDE_EncodingNonUTF8		(0x01<<4)	  
 #define ASDE_KDE				(0x01<<5)	  
 #define ASDE_GNOME				(0x01<<6)	  
 #define ASDE_ASModule			(0x01<<7)	  
--- libAfterConf/DesktopEntry.c	2007-07-13 12:18:26.000000000 -0500
+++ libAfterConf/DesktopEntry.c	2011-12-05 15:43:23.000000000 -0600
@@ -144,7 +144,7 @@
 			break;
 		++i ;
 	}
-	if((locale[i] == '.' || locale[i] == '\0') && ptr[i] == ']' )
+	if((locale[i] == '.' || locale[i] == '_' || locale[i] == '\0') && ptr[i] == ']' )
 		return stripcpy(ptr+i+2) ;
 	return NULL ;
 }
@@ -188,9 +188,9 @@
 		char *val = stripcpy_localized(ptr+8); 
 		if( val ) 
 			set_string( &(de->Comment_localized), val );
-	}else if( mystrncasecmp( ptr, "Encoding=UTF-8", 14 ) == 0 ) 
+	}else if( mystrncasecmp( ptr, "Encoding=", 9 ) == 0 && mystrncasecmp(ptr+9, "UTF-8", 5 ) != 0)
 	{	
-		set_flags( de->flags, ASDE_EncodingUTF8 );
+		set_flags( de->flags, ASDE_EncodingNonUTF8 );
 	}else
 	{
 		PARSE_ASDE_STRING_VAL(Name)
--- src/afterstep/dirtree.c	2006-12-08 14:01:54.000000000 -0600
+++ src/afterstep/dirtree.c	2011-12-01 00:25:19.000000000 -0600
@@ -336,6 +336,7 @@
 	ASSERT_TREE(tree);
 
 	dc = name2desktop_category( reference, &ct ); 
+	if (!dc) return;
 	de = fetch_desktop_entry( ct, dc->index_name?dc->index_name:dc->name ); 
 
 	if( dup_desktop_entry_Name( de, &(tree->name) ) )
--- src/ASDocGen/docfile.c	2008-06-24 17:18:31.000000000 -0500
+++ src/ASDocGen/docfile.c	2011-12-01 00:05:26.000000000 -0600
@@ -181,7 +181,9 @@
 									 ".SH NAME\n"
 									 "\\fB%s\\fP", state->doc_name );
 			if( state->display_purpose[0] != '\0' )
-				fprintf( state->dest_fp, "\\ - %s", state->display_purpose );
+				fprintf( state->dest_fp, "\\ \\- %s", state->display_purpose );
+			else				
+				fprintf( state->dest_fp, "\\ \\- Afterstep %s", state->doc_name );
 			fputc( '\n', state->dest_fp );
 		    break ;
 		default:
--- libAfterImage/export.c	2010-09-23 15:52:15.000000000 -0500
+++ libAfterImage/export.c	2011-12-05 15:43:23.000000000 -0600
@@ -112,11 +112,8 @@
 #include "import.h"
 #include "export.h"
 #include "ascmap.h"
-#include "bmp.h"
+//#include "bmp.h"
 
-#ifdef jmpbuf
-#undef jmpbuf
-#endif
 
 /***********************************************************************************/
 /* High level interface : 														   */
@@ -182,7 +179,7 @@
 /***********************************************************************************/
 /* Some helper functions :                                                         */
 
-static FILE*
+FILE*
 open_writeable_image_file( const char *path )
 {
 	FILE *fp = NULL;
@@ -496,7 +493,7 @@
 	png_ptr = png_create_write_struct( PNG_LIBPNG_VER_STRING, NULL, NULL, NULL );
     if ( png_ptr != NULL )
     	if( (info_ptr = png_create_info_struct(png_ptr)) != NULL )
-			if( setjmp(png_ptr->jmpbuf) )
+			if( setjmp(png_jmpbuf(png_ptr)) )
 			{
 				png_destroy_info_struct(png_ptr, (png_infopp) &info_ptr);
 				info_ptr = NULL ;
@@ -925,100 +922,7 @@
 }
 
 /***********************************************************************************/
-/* Windows BMP file format :   									   				   */
-static size_t
-bmp_write32 (FILE *fp, CARD32 *data, int count)
-{
-  	size_t total = count;
-	if( count > 0 )
-	{
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		CARD8 *raw = (CARD8*)data ;
-#endif
-		count = 0 ;
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		while( count < total )
-		{
-			data[count] = (raw[0]<<24)|(raw[1]<<16)|(raw[2]<<8)|raw[3];
-			++count ;
-			raw += 4 ;
-		}
-#endif
-		total = fwrite((char*) data, sizeof (CARD8), total<<2, fp)>>2;
-	}
-	return total;
-}
-
-static size_t
-bmp_write16 (FILE *fp, CARD16 *data, int count)
-{
-  	size_t total = count;
-	if( count > 0 )
-	{
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		CARD8 *raw = (CARD8*)data ;
-#endif
-		count = 0 ;
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		while( count < total )
-		{
-			data[count] = (raw[0]<<16)|raw[1];
-			++count ;
-			raw += 2 ;
-		}
-#endif
-		total = fwrite((char*) data, sizeof (CARD8), total<<1, fp)>>1;
-	}
-	return total;
-}
-
-Bool
-ASImage2bmp ( ASImage *im, const char *path,  ASImageExportParams *params )
-{
-	Bool success = False;
-	FILE *outfile = NULL ;
-	START_TIME(started);
-
-	if ((outfile = open_writeable_image_file( path )) != NULL)
-	{
-		void *bmbits ;
-		BITMAPINFO *bmi = ASImage2DBI( get_default_asvisual(), im, 0, 0, im->width, im->height, &bmbits, 0 );
-		if( bmi != NULL && bmbits != NULL ) 
-		{
-			BITMAPFILEHEADER bmh ;
-			int bits_size = (((bmi->bmiHeader.biWidth*3+3)/4)*4)*bmi->bmiHeader.biHeight;          /* DWORD aligned */
-
-			bmh.bfType = BMP_SIGNATURE;
-		    bmh.bfSize = 14+bmi->bmiHeader.biSize+bits_size; /* Specifies the size, in bytes, of the bitmap file */
-		    bmh.bfReserved1 = 0;
-			bmh.bfReserved2 = 0;
-		    bmh.bfOffBits = 14+bmi->bmiHeader.biSize; /* Specifies the offset, in bytes, 
-							   * from the BITMAPFILEHEADER structure to the bitmap bits */
-			/* writing off the header */
-			bmp_write16( outfile, &bmh.bfType, 1 );
-			bmp_write32( outfile, &bmh.bfSize, 3 );
-			/* writing off the bitmapinfo : */
-			bmp_write32( outfile, &bmi->bmiHeader.biSize, 1 );
-			bmp_write32( outfile, (CARD32*)&bmi->bmiHeader.biWidth, 2 );
-			bmp_write16( outfile, &bmi->bmiHeader.biPlanes, 2 );
-			/* bmi->bmiHeader.biCompression = 0 ; */
-			bmp_write32( outfile, &bmi->bmiHeader.biCompression, 6 );
-
-			/* writing off the bitmapbits */
-			if (fwrite( bmbits, sizeof(CARD8), bits_size, outfile ) == bits_size)
-				success = True;
-				
-			free( bmbits );
-			free( bmi );
-			
-		}
-		if (outfile != stdout)
-			fclose(outfile);
-	}
-	SHOW_TIME("image export",started);
-	return success;
-}
-
+/* Windows BMP file format :   	see bmp.c								   				   */
 /***********************************************************************************/
 /* Windows ICO/CUR file format :   									   			   */
 Bool
--- afterstep/forms	2000-10-19 22:27:57.000000000 -0500
+++ afterstep/forms	2011-12-01 11:01:12.000000000 -0600
@@ -17,7 +17,7 @@
 *QuitFormButton   quit      "Logout"  ^M
 *QuitFormCommand  Quit
 *QuitFormButton   quit      "Cancel"  ^[
-*QuitFormCommand  Nop
+*QuitFormCommand  Nop	""
 
 
 # FTP
@@ -40,10 +40,10 @@
 *FTPFormInput           CustomTarget    20      ""
 *FTPFormLine            expand
 *FTPFormButton          quit            "Go"    ^M
-*FTPFormCommand         Exec "-" xterm -fg white -T FTP -e ftp $(CommonTarget) $(CustomTarget)
+*FTPFormCommand         Exec "-" x-terminal-emulator -T FTP -e ftp $(CommonTarget) $(CustomTarget)
 *FTPFormButton          restart         "Clear"
 *FTPFormButton          quit            "Cancel" ^[
-*FTPFormCommand         Nop
+*FTPFormCommand         Nop	""
 
 # Xgrabsc
 *XGRABSCFormWarpPointer
@@ -62,10 +62,11 @@
 *XGRABSCFormInput           SaveTarget    35      "~/screenshot.xpm"
 *XGRABSCFormLine            expand
 *XGRABSCFormButton          quit            "Go"    ^M
-*XGRABSCFormCommand         Exec "-" xgrabsc -root -o $(SaveTarget) -bm -s $(WaitTarget) 
+#*XGRABSCFormCommand         Exec "-" xgrabsc -root -o $(SaveTarget) -bm -s $(WaitTarget) 
+*XGRABSCFormCommand         Exec "-" import -delay $(WaitTarget) $(SaveTarget)
 *XGRABSCFormButton          restart         "Clear"
 *XGRABSCFormButton          quit            "Cancel" ^[
-*XGRABSCFormCommand         Nop
+*XGRABSCFormCommand         Nop	""
 
 # Xgrab
 *XGRABFormWarpPointer
@@ -88,7 +89,7 @@
 
 *XGRABFormButton          restart         "Clear"
 *XGRABFormButton          quit            "Cancel" ^[
-*XGRABFormCommand         Nop
+*XGRABFormCommand         Nop	""
 
 # Xlock
 *XLOCKFormWarpPointer
@@ -161,7 +162,7 @@
 *XLOCKFormCommand         Exec "-" xlock -nolock -mode $(CommonTarget)
 *XLOCKFormButton          restart         "Clear"
 *XLOCKFormButton          quit            "Cancel" ^[
-*XLOCKFormCommand         Nop
+*XLOCKFormCommand         Nop	""
 
 *RUNFormWarpPointer
 *RUNFormFore            Grey70
@@ -177,10 +178,10 @@
 *RUNFormInput           CustomTarget    50      ""
 *RUNFormLine            expand
 *RUNFormButton          quit            "Go"    ^M
-*RUNFormCommand         Exec "-" xterm -fg white -bg black -T Run -e $(CustomTarget)
+*RUNFormCommand         Exec "-" x-terminal-emulator -T Run -e $(CustomTarget)
 *RUNFormButton          restart         "Clear"
 *RUNFormButton          quit            "Cancel" ^[
-*RUNFormCommand         Nop
+*RUNFormCommand         Nop	""
 
 *HELPFormWarpPointer
 *HELPFormFore            Grey70
@@ -196,10 +197,10 @@
 *HELPFormInput           CustomTarget    50      ""
 *HELPFormLine            expand
 *HELPFormButton          quit            "Go"    ^M
-*HELPFormCommand         Exec "-" xterm -fg white -bg black -T Help -e man $(CustomTarget)
+*HELPFormCommand         Exec "-" x-terminal-emulator -T Help -e man $(CustomTarget)
 *HELPFormButton          restart         "Clear"
 *HELPFormButton          quit            "Cancel" ^[
-*HELPFormCommand         Nop
+*HELPFormCommand         Nop	""
 
 *FINDFormWarpPointer
 *FINDFormFore            Grey70
@@ -215,10 +216,10 @@
 *FINDFormInput           CustomTarget    50      ""
 *FINDFormLine            expand
 *FINDFormButton          quit            "Go"    ^M
-*FINDFormCommand         Exec "-" xterm -fg white -bg black -T Find -e sh -c "locate $(CustomTarget) | less"
+*FINDFormCommand         Exec "-" x-terminal-emulator -T Find -e sh -c "locate $(CustomTarget) | less"
 *FINDFormButton          restart         "Clear"
 *FINDFormButton          quit            "Cancel" ^[
-*FINDFormCommand         Nop
+*FINDFormCommand         Nop	""
 
 *ThemeCreateFormWarpPointer
 *ThemeCreateFormFore            Grey70
@@ -244,4 +245,4 @@
 *ThemeCreateFormCommand         Exec "-" makeastheme.pl $(Background!--no_background) $(Pager!--no_pager) $(Wharf!--no_wharf) $(WinList!--no_winlist) --theme $(CustomTarget)
 *ThemeCreateFormButton          restart         "Clear"
 *ThemeCreateFormButton          quit            "Cancel" ^[
-*ThemeCreateFormCommand         Nop
+*ThemeCreateFormCommand         Nop	""
--- libAfterConf/Ident.c	2008-06-13 11:32:50.000000000 -0500
+++ libAfterConf/Ident.c	2011-12-01 00:14:08.000000000 -0600
@@ -126,7 +126,7 @@
 
 	CopyFreeStorage (&Storage, config->more_stuff);
     if (config->style_defs)
-        *tail = MyStyleDefinitionsList2free_storage (&IdentSyntax, config->style_defs);
+        *tail = MyStyleDefinitionsList2free_storage (config->style_defs, &IdentSyntax);
 	ADVANCE_LINKED_LIST_TAIL(tail);
 
 	/* building free storage here */
--- libAfterImage/imencdec.h	2008-05-29 17:23:25.000000000 -0500
+++ libAfterImage/imencdec.h	2011-12-01 00:05:26.000000000 -0600
@@ -242,7 +242,7 @@
  * empty scanlines while writing ASImage. If back_color of empty scanline
  * matches back_color of ASImageOutput - then particular line is erased!
  * If back_colors are same - then particular line of ASImage gets filled
- * with the back_color of ASScanline. First approach is usefull when
+ * with the back_color of ASScanline. First approach is useful when
  * resulting image will be used in subsequent call to merge_layers - in
  * such case knowing back_color of image is good enough and we don't need
  * to store lines with the same color. In case where ASImage will be
--- libAfterImage/import.c	2010-09-23 15:57:57.000000000 -0500
+++ libAfterImage/import.c	2011-12-06 00:19:26.000000000 -0600
@@ -115,7 +115,6 @@
 
 #include "asimage.h"
 #include "imencdec.h"
-#include "bmp.h"
 #include "scanline.h"
 #include "ximage.h"
 #include "xcf.h"
@@ -125,10 +124,6 @@
 #include "asimagexml.h"
 #include "transform.h"
 
-#ifdef jmpbuf
-#undef jmpbuf
-#endif
-
 
 /***********************************************************************************/
 /* High level interface : 														   */
@@ -458,16 +453,92 @@
 	if( pdst_h ) *pdst_h = dst_h ; 
 }
 
+static char* thumbnail_dir = NULL;
+/* exported */ void set_asimage_thumbnails_cache_dir(const char* p_thumbnail_dir)
+{
+	struct stat stbuf;
+	if (thumbnail_dir && p_thumbnail_dir
+		&& !strcmp(thumbnail_dir, p_thumbnail_dir))
+		return;
+
+	if (thumbnail_dir)
+	{
+		free(thumbnail_dir);
+		thumbnail_dir = NULL;
+	}
+
+	if (p_thumbnail_dir
+		&& stat(p_thumbnail_dir, &stbuf) == 0
+		&& S_ISDIR(stbuf.st_mode))
+	{
+		thumbnail_dir = strdup(p_thumbnail_dir);
+		DEBUG_OUT("set thumbnail dir to %s", thumbnail_dir);
+	}
+}
+
+static char* get_thumbnail_dir()
+{
+	return thumbnail_dir;
+}
+
+static char* get_thumbnail_image_path(const char * file, ASImageImportParams *iparams, int * need_save)
+{
+	* need_save = 0;
+	char *th_dir = get_thumbnail_dir();
+	if (!th_dir || !*th_dir)
+		return NULL;
+
+	static char result[2048];
+	char * realfilename = locate_image_file_in_path( file, iparams );
+	if (!realfilename)
+		return NULL;
+
+	struct stat rbuf;
+	if (stat(realfilename, &rbuf) == -1)
+	{
+		DEBUG_OUT("image file %s does not exist", realfilename);
+		return NULL;
+	}
+
+	if (snprintf(result, sizeof(result), "%s/%s-%dx%d.png", th_dir, realfilename,
+							    iparams->height, iparams->width) >= sizeof(result))
+	{
+		DEBUG_OUT("thumbnail path too long for file %s", file);
+		return NULL;
+	}
+
+	char *tmp;
+	for(tmp = result + strlen(th_dir) + 1; *tmp; ++tmp)
+		if (*tmp == '/') *tmp = '_';
+
+	struct stat thbuf;
+	if (stat(result, &thbuf) == -1)
+		thbuf.st_ctime = 0;
+
+	*need_save = rbuf.st_ctime > thbuf.st_ctime;
+	return result;
+}
+
+
 void print_asimage_func (ASHashableValue value);
 ASImage *
 get_thumbnail_asimage( ASImageManager* imageman, const char *file, int thumb_width, int thumb_height, ASFlagType flags )
 {
 	ASImage *im = NULL ;
+#define AS_THUMBNAIL_NAME_FORMAT2	"%d_%s_%dx%dthumb%ld"
+	size_t len = strlen(file);
+	char *thumbnail_name = safemalloc( len+sizeof(AS_THUMBNAIL_NAME_FORMAT2)+80 );
+
+
+
+	if (imageman && file)
+	{
+		sprintf( thumbnail_name, AS_THUMBNAIL_NAME_FORMAT2, len, file, thumb_width, thumb_height, (long) flags) ;
+		im = fetch_asimage(imageman, thumbnail_name );
+	}
 	
-	if( imageman && file )
+	if( !im && imageman && file )
 	{
-#define AS_THUMBNAIL_NAME_FORMAT	"%s_scaled_to_%dx%d"
-		char *thumbnail_name = safemalloc( strlen(file)+sizeof(AS_THUMBNAIL_NAME_FORMAT)+32 );
 		ASImage *original_im = query_asimage(imageman, file );
 
 		if( thumb_width <= 0 && thumb_height <= 0 ) 
@@ -490,8 +561,7 @@
 
 		if( thumb_width > 0 && thumb_height > 0 ) 
 		{
-			sprintf( thumbnail_name, AS_THUMBNAIL_NAME_FORMAT, file, thumb_width, thumb_height ) ;
-			im = fetch_asimage(imageman, thumbnail_name );
+			//im = fetch_asimage(imageman, thumbnail_name );
 			if( im == NULL )
 			{
 				if( original_im != NULL ) /* simply scale it down to a thumbnail size */
@@ -510,7 +580,7 @@
 		
 		if( im == NULL ) 	
 		{
-			ASImage *tmp ; 
+			ASImage *tmp = NULL; 
 			ASImageImportParams iparams ;
 
 			init_asimage_import_params( &iparams );
@@ -524,8 +594,18 @@
 			
 			if( get_flags( flags, AS_THUMBNAIL_DONT_ENLARGE ) )
 				iparams.flags |= AS_IMPORT_FAST ; 
-			
-			tmp = file2ASImage_extra( file, &iparams );
+
+			int save_thumbnail = 0;
+			char * thumbfile = get_thumbnail_image_path(file, &iparams, &save_thumbnail);
+			if (thumbfile) thumbfile = strdup(thumbfile);
+			if (!save_thumbnail && thumbfile)
+				tmp = file2ASImage_extra( thumbfile, &iparams );
+			LOCAL_DEBUG_OUT("Thumbnail path: %s --> %s, %d , %p", file, thumbfile, save_thumbnail, tmp);
+			if (!tmp)
+			{
+				tmp = file2ASImage_extra( file, &iparams );
+				save_thumbnail = 1;
+			}
 			if( tmp ) 
 			{
 				im = tmp ; 
@@ -534,7 +614,7 @@
 					if( get_flags(flags, AS_THUMBNAIL_PROPORTIONAL ) ) 
 					{
 						calculate_proportions( tmp->width, tmp->height, &thumb_width, &thumb_height );
-						sprintf( thumbnail_name, AS_THUMBNAIL_NAME_FORMAT, file, thumb_width, thumb_height );
+						//sprintf( thumbnail_name, AS_THUMBNAIL_NAME_FORMAT, file, thumb_height );
 						if( (im = query_asimage( imageman, thumbnail_name )) == NULL ) 
 							im = tmp ; 
 					}
@@ -559,14 +639,27 @@
 				}
 				
 				if( im != tmp ) 
-					destroy_asimage( &tmp );				
+					destroy_asimage( &tmp );
+				if (save_thumbnail && thumbfile)
+				{
+					LOCAL_DEBUG_OUT("Saving thumbnail to file %s", thumbfile);
+					save_asimage_to_file(thumbfile,
+							     im,
+							     "png",
+							     NULL,
+							     NULL,
+							     0,
+							     1
+							     );
+				}
 			}
-		
+
+			if (thumbfile) free(thumbfile);	
 		}
 								 
-		if( thumbnail_name ) 
-			free( thumbnail_name );
 	}
+	if( thumbnail_name )
+		free( thumbnail_name );
 	return im;
 }
 
@@ -929,7 +1022,7 @@
 	return realfilename;
 }
 
-static FILE*
+FILE*
 open_image_file( const char *path )
 {
 	FILE *fp = NULL;
@@ -1251,7 +1344,7 @@
 			 * the normal method of doing things with libpng).  REQUIRED unless you
 			 * set up your own error handlers in the png_create_read_struct() earlier.
 			 */
-			if ( !setjmp (png_ptr->jmpbuf))
+			if ( !setjmp (png_jmpbuf(png_ptr)) )
 			{
 				ASFlagType rgb_flags = ASStorage_RLEDiffCompress|ASStorage_32Bit ;
 
@@ -1468,7 +1561,7 @@
 
 static void asim_png_read_data(png_structp png_ptr, png_bytep data, png_size_t length)
 {
-   ASImPNGReadBuffer *buf = (ASImPNGReadBuffer *)png_ptr->io_ptr;
+   ASImPNGReadBuffer *buf = (ASImPNGReadBuffer *)(png_get_io_ptr(png_ptr));
    memcpy(data, buf->buffer, length);
    buf->buffer += length;
 }
@@ -1873,268 +1966,6 @@
 }
 
 /***********************************************************************************/
-/* Windows BMP file format :   									   				   */
-static size_t
-bmp_read32 (FILE *fp, CARD32 *data, int count)
-{
-  	size_t total = count;
-	if( count > 0 )
-	{
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		CARD8 *raw = (CARD8*)data ;
-#endif
-		total = fread((char*) data, sizeof (CARD8), count<<2, fp)>>2;
-		count = 0 ;
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		while( count < total )
-		{
-			data[count] = (raw[0]<<24)|(raw[1]<<16)|(raw[2]<<8)|raw[3];
-			++count ;
-			raw += 4 ;
-		}
-#endif
-	}
-	return total;
-}
-
-static size_t
-bmp_read16 (FILE *fp, CARD16 *data, int count)
-{
-  	size_t total = count;
-	if( count > 0 )
-	{
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		CARD8 *raw = (CARD8*)data ;
-#endif
-		total = fread((char*) data, sizeof (CARD8), count<<1, fp)>>1;
-		count = 0 ;
-#ifdef WORDS_BIGENDIAN                         /* BMPs are encoded as Little Endian */
-		while( count < total )
-		{
-			data[count] = (raw[0]<<16)|raw[1];
-			++count ;
-			raw += 2 ;
-		}
-#endif
-	}
-	return total;
-}
-
-
-ASImage *
-read_bmp_image( FILE *infile, size_t data_offset, BITMAPINFOHEADER *bmp_info,
-				ASScanline *buf, CARD8 *gamma_table,
-				unsigned int width, unsigned int height,
-				Bool add_colormap, unsigned int compression )
-{
-	Bool success = False ;
-	CARD8 *cmap = NULL ;
-	int cmap_entries = 0, cmap_entry_size = 4, row_size ;
-	int y;
-	ASImage *im = NULL ;
-	CARD8 *data ;
-	int direction = -1 ;
-
-	if( bmp_read32( infile, &bmp_info->biSize, 1 ) )
-	{
-		if( bmp_info->biSize == 40 )
-		{/* long header */
-			bmp_read32( infile, (CARD32*)&bmp_info->biWidth, 2 );
-			bmp_read16( infile, &bmp_info->biPlanes, 2 );
-			bmp_info->biCompression = 1 ;
-			success = (bmp_read32( infile, &bmp_info->biCompression, 6 )==6);
-		}else
-		{
-			CARD16 dumm[2] ;
-			bmp_read16( infile, &dumm[0], 2 );
-			bmp_info->biWidth = dumm[0] ;
-			bmp_info->biHeight = dumm[1] ;
-			success = ( bmp_read16( infile, &bmp_info->biPlanes, 2 ) == 2 );
-			bmp_info->biCompression = 0 ;
-		}
-	}
-#ifdef LOCAL_DEBUG
-	fprintf( stderr, "bmp.info.biSize = %ld(0x%lX)\n", bmp_info->biSize, bmp_info->biSize );
-	fprintf( stderr, "bmp.info.biWidth = %ld\nbmp.info.biHeight = %ld\n",  bmp_info->biWidth,  bmp_info->biHeight );
-	fprintf( stderr, "bmp.info.biPlanes = %d\nbmp.info.biBitCount = %d\n", bmp_info->biPlanes, bmp_info->biBitCount );
-	fprintf( stderr, "bmp.info.biCompression = %ld\n", bmp_info->biCompression );
-	fprintf( stderr, "bmp.info.biSizeImage = %ld\n", bmp_info->biSizeImage );
-#endif
-	if( ((int)(bmp_info->biHeight)) < 0 )
-		direction = 1 ;
-	if( height == 0 )
-		height  = direction == 1 ? -((long)(bmp_info->biHeight)):bmp_info->biHeight ;
-	if( width == 0 )
-		width = bmp_info->biWidth ;
-
-	if( !success || bmp_info->biCompression != 0 ||
-		width > MAX_IMPORT_IMAGE_SIZE ||
-		height > MAX_IMPORT_IMAGE_SIZE )
-	{
-		return NULL;
-	}
-	if( bmp_info->biBitCount < 16 )
-		cmap_entries = 0x01<<bmp_info->biBitCount ;
-
-	if( bmp_info->biSize != 40 )
-		cmap_entry_size = 3;
-	if( cmap_entries )
-	{
-		cmap = safemalloc( cmap_entries * cmap_entry_size );
-		fread(cmap, sizeof (CARD8), cmap_entries * cmap_entry_size, infile);
-	}
-
-	if( add_colormap )
-		data_offset += cmap_entries*cmap_entry_size ;
-
-	fseek( infile, data_offset, SEEK_SET );
-	row_size = (width*bmp_info->biBitCount)>>3 ;
-	if( row_size == 0 )
-		row_size = 1 ;
-	else
-		row_size = (row_size+3)/4 ;            /* everything is aligned by 32 bits */
-	row_size *= 4 ;                            /* in bytes  */
-	data = safemalloc( row_size );
-
-	im = create_asimage( width,  height, compression );
-	/* Window BMP files are little endian  - we need to swap Red and Blue */
-	prepare_scanline( im->width, 0, buf, True );
-
-	y =( direction == 1 )?0:height-1 ;
-	while( y >= 0 && y < (int)height)
-	{
-		if( fread( data, sizeof (char), row_size, infile ) < (unsigned int)row_size )
-			break;
- 		dib_data_to_scanline(buf, bmp_info, gamma_table, data, cmap, cmap_entry_size); 
-		asimage_add_line (im, IC_RED,   buf->red  , y);
-		asimage_add_line (im, IC_GREEN, buf->green, y);
-		asimage_add_line (im, IC_BLUE,  buf->blue , y);
-		y += direction ;
-	}
-	free( data );
-	if( cmap )
-		free( cmap );
-	return im ;
-}
-
-ASImage *
-bmp2ASImage( const char * path, ASImageImportParams *params )
-{
-	ASImage *im = NULL ;
-	/* More stuff */
-	FILE         *infile;					   /* source file */
-	ASScanline    buf;
-	BITMAPFILEHEADER  bmp_header ;
-	BITMAPINFOHEADER  bmp_info;
-	START_TIME(started);
-
-
-	if ((infile = open_image_file(path)) == NULL)
-		return NULL;
-
-	bmp_header.bfType = 0 ;
-	if( bmp_read16( infile, &bmp_header.bfType, 1 ) )
-		if( bmp_header.bfType == BMP_SIGNATURE )
-			if( bmp_read32( infile, &bmp_header.bfSize, 3 ) == 3 )
-				im = read_bmp_image( infile, bmp_header.bfOffBits, &bmp_info, &buf, params->gamma_table, 0, 0, False, params->compression );
-#ifdef LOCAL_DEBUG
-	fprintf( stderr, "bmp.header.bfType = 0x%X\nbmp.header.bfSize = %ld\nbmp.header.bfOffBits = %ld(0x%lX)\n",
-					  bmp_header.bfType, bmp_header.bfSize, bmp_header.bfOffBits, bmp_header.bfOffBits );
-#endif
-	if( im != NULL )
-		free_scanline( &buf, True );
-	else
-		show_error( "invalid or unsupported BMP format in image file \"%s\"", path );
-
-	fclose( infile );
-	SHOW_TIME("image loading",started);
-	return im ;
-}
-
-/***********************************************************************************/
-/* Windows ICO/CUR file format :   									   			   */
-
-ASImage *
-ico2ASImage( const char * path, ASImageImportParams *params )
-{
-	ASImage *im = NULL ;
-	/* More stuff */
-	FILE         *infile;					   /* source file */
-	ASScanline    buf;
-	int y, mask_bytes;
-    CARD8  *and_mask;
-	START_TIME(started);
-	struct IconDirectoryEntry {
-    	CARD8  bWidth;
-    	CARD8  bHeight;
-    	CARD8  bColorCount;
-    	CARD8  bReserved;
-    	CARD16  wPlanes;
-    	CARD16  wBitCount;
-    	CARD32 dwBytesInRes;
-    	CARD32 dwImageOffset;
-	};
-	struct ICONDIR {
-    	CARD16          idReserved;
-    	CARD16          idType;
-    	CARD16          idCount;
-	} icon_dir;
-   	struct IconDirectoryEntry  icon;
-	BITMAPINFOHEADER bmp_info;
-
-	if ((infile = open_image_file(path)) == NULL)
-		return NULL;
-
-	icon_dir.idType = 0 ;
-	if( bmp_read16( infile, &icon_dir.idReserved, 3 ) == 3)
-		if( icon_dir.idType == 1 || icon_dir.idType == 2)
-		{
-			fread( &(icon.bWidth), sizeof(CARD8),4,infile );
-			bmp_read16( infile, &(icon.wPlanes), 2 );
-			if( bmp_read32( infile, &(icon.dwBytesInRes), 2 ) == 2 )
-			{
-				fseek( infile, icon.dwImageOffset, SEEK_SET );
-				im = read_bmp_image( infile, icon.dwImageOffset+40+(icon.bColorCount*4), &bmp_info, &buf, params->gamma_table,
-					                 icon.bWidth, icon.bHeight, (icon.bColorCount==0), params->compression );
-			}
-		}
-#ifdef LOCAL_DEBUG
-	fprintf( stderr, "icon.dir.idType = 0x%X\nicon.dir.idCount = %d\n",  icon_dir.idType, icon_dir.idCount );
-	fprintf( stderr, "icon[1].bWidth = %d(0x%X)\n",  icon.bWidth,  icon.bWidth );
-	fprintf( stderr, "icon[1].bHeight = %d(0x%X)\n",  icon.bHeight,  icon.bHeight );
-	fprintf( stderr, "icon[1].bColorCount = %d\n",  icon.bColorCount );
-	fprintf( stderr, "icon[1].dwImageOffset = %ld(0x%lX)\n",  icon.dwImageOffset,  icon.dwImageOffset );
-    fprintf( stderr, "icon[1].bmp_size = %ld\n",  icon.dwBytesInRes );
-    fprintf( stderr, "icon[1].dwBytesInRes = %ld\n",  icon.dwBytesInRes );
-#endif
-	if( im != NULL )
-	{
-        mask_bytes = ((icon.bWidth>>3)+3)/4 ;    /* everything is aligned by 32 bits */
-        mask_bytes *= 4 ;                      /* in bytes  */
-        and_mask = safemalloc( mask_bytes );
-        for( y = icon.bHeight-1 ; y >= 0 ; y-- )
-		{
-			int x ;
-            if( fread( and_mask, sizeof (CARD8), mask_bytes, infile ) < (unsigned int)mask_bytes )
-				break;
-			for( x = 0 ; x < icon.bWidth ; ++x )
-            {
-				buf.alpha[x] = (and_mask[x>>3]&(0x80>>(x&0x7)))? 0x0000 : 0x00FF ;
-            }
-			im->channels[IC_ALPHA][y]  = store_data( NULL, (CARD8*)buf.alpha, im->width*4, 
-													 ASStorage_32BitRLE|ASStorage_Bitmap, 0);
-		}
-        free( and_mask );
-		free_scanline( &buf, True );
-	}else
-		show_error( "invalid or unsupported ICO format in image file \"%s\"", path );
-
-	fclose( infile );
-	SHOW_TIME("image loading",started);
-	return im ;
-}
-
-/***********************************************************************************/
 #ifdef HAVE_GIF		/* GIF GIF GIF GIF GIF GIF GIF GIF GIF GIF GIF GIF GIF GIF GIF GIF */
 
 int
--- src/tools/ASWallpaper/interface.c	2006-11-15 12:25:13.000000000 -0600
+++ src/tools/ASWallpaper/interface.c	2011-12-01 00:05:26.000000000 -0600
@@ -349,7 +349,7 @@
 
 	mx->tint_radio = gtk_radio_button_new_with_label( NULL, "Use Tinting (suitable for mostly grayscale images)" );
 	gtk_box_pack_start (GTK_BOX (box), mx->tint_radio, FALSE, FALSE, 0);
-	mx->hsv_radio = gtk_radio_button_new_with_label_from_widget( GTK_RADIO_BUTTON(mx->tint_radio), "Use Hue rotation (suitable for colorfull images)" );
+	mx->hsv_radio = gtk_radio_button_new_with_label_from_widget( GTK_RADIO_BUTTON(mx->tint_radio), "Use Hue rotation (suitable for colorful images)" );
 	gtk_box_pack_start (GTK_BOX (box), mx->hsv_radio, FALSE, FALSE, 0);
 	colorize_gtk_widget( frame, get_colorschemed_style_normal() );
 	gtk_widget_show_all (box);
--- libAfterImage/libjpeg/jchuff.c	2010-01-29 10:16:35.000000000 -0600
+++ libAfterImage/libjpeg/jchuff.c	2011-06-29 17:38:00.000000000 -0500
@@ -1554,7 +1554,7 @@
  */
 
 GLOBAL(void)
-jinit_huff_encoder (j_compress_ptr cinfo)
+_jinit_huff_encoder (j_compress_ptr cinfo) /* SASHA*/
 {
   huff_entropy_ptr entropy;
   int i;
--- libAfterImage/libjpeg/jdhuff.c	2010-01-29 10:16:35.000000000 -0600
+++ libAfterImage/libjpeg/jdhuff.c	2011-06-29 17:38:00.000000000 -0500
@@ -1506,7 +1506,7 @@
  */
 
 GLOBAL(void)
-jinit_huff_decoder (j_decompress_ptr cinfo)
+_jinit_huff_decoder (j_decompress_ptr cinfo) /*SASHA*/
 {
   huff_entropy_ptr entropy;
   int i;
--- libAfterImage/libjpeg/jpegint.h	2010-01-29 10:16:35.000000000 -0600
+++ libAfterImage/libjpeg/jpegint.h	2011-06-29 17:38:00.000000000 -0500
@@ -301,7 +301,7 @@
 #define jinit_color_converter	jICColor
 #define jinit_downsampler	jIDownsampler
 #define jinit_forward_dct	jIFDCT
-#define jinit_huff_encoder	jIHEncoder
+#define _jinit_huff_encoder	jIHEncoder
 #define jinit_arith_encoder	jIAEncoder
 #define jinit_marker_writer	jIMWriter
 #define jinit_master_decompress	jIDMaster
@@ -349,7 +349,8 @@
 EXTERN(void) jinit_color_converter JPP((j_compress_ptr cinfo));
 EXTERN(void) jinit_downsampler JPP((j_compress_ptr cinfo));
 EXTERN(void) jinit_forward_dct JPP((j_compress_ptr cinfo));
-EXTERN(void) jinit_huff_encoder JPP((j_compress_ptr cinfo));
+EXTERN(void) _jinit_huff_encoder JPP((j_compress_ptr cinfo));
+#define jinit_huff_encoder _jinit_huff_encoder
 EXTERN(void) jinit_arith_encoder JPP((j_compress_ptr cinfo));
 EXTERN(void) jinit_marker_writer JPP((j_compress_ptr cinfo));
 /* Decompression module initialization routines */
@@ -362,7 +363,8 @@
 					  boolean need_full_buffer));
 EXTERN(void) jinit_input_controller JPP((j_decompress_ptr cinfo));
 EXTERN(void) jinit_marker_reader JPP((j_decompress_ptr cinfo));
-EXTERN(void) jinit_huff_decoder JPP((j_decompress_ptr cinfo));
+EXTERN(void) _jinit_huff_decoder JPP((j_decompress_ptr cinfo));
+#define jinit_huff_decoder _jinit_huff_decoder
 EXTERN(void) jinit_arith_decoder JPP((j_decompress_ptr cinfo));
 EXTERN(void) jinit_inverse_dct JPP((j_decompress_ptr cinfo));
 EXTERN(void) jinit_upsampler JPP((j_decompress_ptr cinfo));
--- tools/makeasclean	2004-05-20 17:25:45.000000000 -0500
+++ tools/makeasclean	2011-12-01 00:25:19.000000000 -0600
@@ -26,7 +26,8 @@
 rm -f `find . -name "config.cache"`
 rm -f `find . -name "config.log"`
 rm -f `find . -name "config.status"`
-#rm -f `find . -name "*.in" -o -name ".*.in" | sed 's/.in$//'`
+rm -f `find . \( -name "*.in" -o -name ".*.in"  \) -a ! -name "configure.in" | sed 's/.in$//'`
+rm -rf src/ASDocGen/html src/ASDocGen/man src/ASDocGen/log.*
 
 # remove backups
 rm -f `find . -name "*~" -o -name ".*~"`
--- autoconf/Makefile.common.lib.in	2007-04-20 17:10:45.000000000 -0500
+++ autoconf/Makefile.common.lib.in	2011-12-05 15:43:23.000000000 -0600
@@ -245,7 +245,7 @@
 	$(LN_S) -f $(LIB_SHARED).$(LIBVER) $(LIB_SHARED).$(LIBVERMAJOR)
 
 $(LIB_SHARED).$(LIBVER): $(LIB_OBJS) $(LIB_INCS)
-	$(CC) -shared -Wl,-soname,$(LIB_SHARED).$(LIBVERMAJOR) -o $(LIB_SHARED).$(LIBVER) \
+	$(CC) -shared $(LDFLAGS) -Wl,-soname,$(LIB_SHARED).$(LIBVERMAJOR) -o $(LIB_SHARED).$(LIBVER) \
 	 $(LIB_OBJS)
 
 install:	install.lib install.bin
--- libAfterImage/Makefile.in	2010-01-29 10:44:35.000000000 -0600
+++ libAfterImage/Makefile.in	2011-12-05 15:43:23.000000000 -0600
@@ -397,7 +397,7 @@
 	$(LN_S) -f $(LIB_SHARED).$(LIBVER) $(LIB_SHARED).$(LIBVERMAJOR)
 
 $(LIB_SHARED).$(LIBVER): $(LIB_OBJS) $(LIB_INCS) config.h
-	$(CC) -shared -Wl,-soname,$(LIB_SHARED).$(LIBVERMAJOR) -o $(LIB_SHARED).$(LIBVER) \
+	$(CC) -shared $(LDFLAGS) -Wl,-soname,$(LIB_SHARED).$(LIBVERMAJOR) -o $(LIB_SHARED).$(LIBVER) \
 	 $(LIB_OBJS)
 
 install.man:
--- src/Pager/Pager.man	2001-12-13 00:30:32.000000000 -0600
+++ src/Pager/Pager.man	2011-12-01 00:05:26.000000000 -0600
@@ -179,7 +179,7 @@
 .IP "*PagerBalloon" 
 Mini-window balloon style.
 
-This definitions are dependant on Pager's name, so if you start Pager
+This definitions are dependent on Pager's name, so if you start Pager
 as WPager - you should change all the names, like so :
 "*PagerInActiveDesk" -> "*WPagerInActiveDesk"
 
@@ -257,7 +257,7 @@
 Specifies a font to use to label the window names in the pager. 
 It overrides font specified in Focused/Unfocused/Sticky window style
 in look file. It also displays text on background color - which
-can be usefull if BackPixmap is specified in window style.
+can be useful if BackPixmap is specified in window style.
 Window labels seem to be fairly useless for desktop scales of 32
 or greater.
 
--- doc/Pager.xml	2004-07-09 10:57:10.000000000 -0500
+++ doc/Pager.xml	2011-12-01 00:05:25.000000000 -0600
@@ -265,7 +265,7 @@
   <listitem>
 <para>Mini-window balloon style.</para>
 
-<para>This definitions are dependant on Pager's name, so if you start Pager
+<para>This definitions are dependent on Pager's name, so if you start Pager
 as WPager - you should change all the names, like so :
 "*PagerInActiveDesk" -&gt; "*WPagerInActiveDesk"</para>
 
@@ -419,7 +419,7 @@
 <para>Specifies a font to use to label the window names in the pager. 
 It overrides font specified in Focused/Unfocused/Sticky window style
 in look file. It also displays text on background color - which
-can be usefull if BackPixmap is specified in window style.
+can be useful if BackPixmap is specified in window style.
 Window labels seem to be fairly useless for desktop scales of 32
 or greater.</para>
 
--- afterstep/scripts/Quit	2000-10-19 22:28:04.000000000 -0500
+++ afterstep/scripts/Quit	2011-12-01 00:25:19.000000000 -0600
@@ -72,7 +72,7 @@
     Else
     Begin
      Do {Exec "sync" sync}
-     Do {Exec "xterm" xterm -geometry 80x12+150+130 -bg grey85 -fg red -cr red -e pauseme /sbin/shutdown -h -f now}
+     Do {Exec "X terminal" x-terminal-emulator -e pauseme /sbin/shutdown -h -f now}
      Quit
     End
    End
--- libAfterImage/README	2008-01-15 15:13:30.000000000 -0600
+++ libAfterImage/README	2011-12-01 00:05:26.000000000 -0600
@@ -18,7 +18,7 @@
 libAfterImage will install itself into /usr/local/lib on most
 systems. In addition it will install afterimage-libs script to
 /usr/local/bin. This script can be used to query what libraries
-libAfterImage is dependant on. All of this libraries has to be
+libAfterImage is dependent on. All of this libraries has to be
 linked to, while building an application utilizing libAfterImage.
 Header files for the library will be installed into
 /usr/local/include/libAfterImage on most systems.
--- doc/code/ReleaseGuide	2005-07-19 12:36:09.000000000 -0500
+++ doc/code/ReleaseGuide	2011-12-01 00:05:25.000000000 -0600
@@ -32,7 +32,7 @@
 25) test release on your own computer
 26) realise that you fucked up and go apologise to everybody
 27) watch new release not getting propagated into distros and users installing 
-    some wierd beta from yer back.
+    some weird beta from yer back.
 28) realise futulity of it all and go on a drinking binge
 
 
--- libAfterBase/selfdiag.c	2007-09-20 15:22:51.000000000 -0500
+++ libAfterBase/selfdiag.c	2011-12-01 00:25:19.000000000 -0600
@@ -618,7 +618,7 @@
 		fprintf (stderr,
 				 "If core dump was generated by this fault, please examine it with gdb and attach results to your report.\n");
 		fprintf (stderr, " You can use the following sequence to do so :\n");
-		fprintf (stderr, "   gdb -core core /usr/local/bin/afterstep\n");
+		fprintf (stderr, "   gdb -core core /usr/bin/afterstep\n");
 		fprintf (stderr, "   gdb>backtrace\n");
 		fprintf (stderr, "   gdb>info frame\n");
 		fprintf (stderr, "   gdb>info all-registers\n");
--- libAfterStep/session.c	2005-12-29 17:45:03.000000000 -0600
+++ libAfterStep/session.c	2011-12-06 00:19:26.000000000 -0600
@@ -784,7 +784,8 @@
 		if( f ) 
 		{
 			fprintf( f, "#!/bin/sh\n\n" );
-			fprintf( f, "xterm -e \"%s/postcard.sh\"\n", AFTER_BIN_DIR );
+			fprintf( f, "if [ -r %s/.postcard ] \nthen echo -n \nelse rm %s \nexit\nfi\n", ashome, postcard_fname );
+			fprintf( f, "x-terminal-emulator -e \"%s/tools/postcard.sh\"\n", AFTER_SHAREDIR );
 			fprintf( f, "if [ -r %s/.postcard ] \nthen echo -n \nelse rm %s \nfi\n", ashome, postcard_fname );
 			fclose( f );
 		}
@@ -792,6 +793,11 @@
 		free(postcard_fname);
     }
 
+	char *cachefilename = make_file_name(ashome, "thumbnails");
+    CheckOrCreate(cachefilename);
+	extern void set_asimage_thumbnails_cache_dir(const char*);
+    set_asimage_thumbnails_cache_dir(cachefilename);
+    free( cachefilename );
 }
 
 static const char *
--- afterstep/standard_categories	2007-02-24 20:46:06.000000000 -0600
+++ afterstep/standard_categories	2011-12-01 00:25:19.000000000 -0600
@@ -6,6 +6,8 @@
 Comment=2D based graphical application
 Icon=Folder-Brushes
 Type=Directory
+Name[pl]=Grafika 2D
+Comment[pl]=Aplikacje graficzne 2D
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -14,6 +16,8 @@
 Categories=Graphics
 Comment=3D based graphical application
 Type=Directory
+Name[pl]=Grafika 3D
+Comment[pl]=Aplikacje graficzne 3D
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -162,6 +166,8 @@
 Comment=An action game
 icon=Folder-Pistol
 Type=Directory
+Name[pl]=Gry zręcznościowe
+Comment[pl]=Gry zręcznościowe
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -171,6 +177,8 @@
 Comment=Adventure style game
 icon=Folder-Knight
 Type=Directory
+Name[pl]=Gry przygodowe
+Comment[pl]=Gry przygodowe
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -377,7 +385,7 @@
 Name[nds]=Speelhall
 Name[nn]=Arkade
 Name[pa]=ਅਰਕਾਡੀ
-Name[pl]=Gry zręcznościowe
+Name[pl]=Automaty
 Name[pt]=Arcada
 Name[ro]=Aventuri
 Name[ru]=Аркады
@@ -402,6 +410,7 @@
 Name[zh_CN]=街机
 Name[zh_TW]=大型遊戲機遊戲
 Name[zu]=Umhhume
+Comment[pl]=Automaty do gry
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -410,6 +419,8 @@
 Categories= 
 Comment=A tool to archive/backup data
 Type=Directory
+Name[pl]=Archiwizacja
+Comment[pl]=Tworzenie kopii bezpieczeństwa i archiwizowanie danych
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -418,6 +429,8 @@
 Categories=Education
 Comment=Software to teach arts
 Type=Directory
+Name[pl]=Sztuka
+Comment[pl]=Oprogramowanie do uczenia się sztuki
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -426,6 +439,8 @@
 Categories=Science
 Comment=Astronomy software
 Type=Directory
+Name[pl]=Astronomia
+Comment[pl]=Oprogramowanie związane z astronomią
 
 
 [DesktopEntry]
@@ -436,6 +451,8 @@
 Comment=An audio application
 icon=Folder-MusicalNote
 Type=Directory
+Name[pl]=Audio
+Comment[pl]=Aplikacje audio
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -583,6 +600,8 @@
 Categories=AudioVideo
 Comment=Application to edit audio/video files
 Type=Directory
+Name[pl]=Edytory multimediów
+Comment[pl]=Aplikacje do edycji plików audio i video.
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -591,6 +610,8 @@
 Categories=Science
 Comment=Biology software
 Type=Directory
+Name[pl]=Biologia
+Comment[pl]=Oprogramowanie związane z biologią
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -693,6 +714,8 @@
 Categories=Utility
 Comment=A calculator
 Type=Directory
+Name[pl]=Kalkulator
+Comment[pl]=Kalkulator
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -701,6 +724,8 @@
 Categories=Office
 Comment=Calendar application
 Type=Directory
+Name[pl]=Kalendarz
+Comment[pl]=Kalendarz
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -795,6 +820,8 @@
 Categories=Science
 Comment=Chemistry software
 Type=Directory
+Name[pl]=Chemia
+Comment[pl]=Oprogramowanie związane z chemią
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -803,6 +830,8 @@
 Categories=Utility
 Comment=A clock application/applet
 Type=Directory
+Name[pl]=Zegar
+Comment[pl]=Zegary
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -827,6 +856,8 @@
 Categories=Office
 Comment=E.g. an address book
 Type=Directory
+Name[pl]=Zarządzanie kontaktami
+Comment[pl]=Na przykład książki adresowe
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1189,6 +1220,7 @@
 Categories= 
 Comment=A file manager
 Type=Directory
+Name[pl]=Menadżery plików
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1198,6 +1230,8 @@
 Comment=Tools like FTP or P2P programs
 icon=Folder-Globe
 Type=Directory
+Name[pl]=Pobieranie plików
+Comment[pl]=Narzędzia takie jak FTP lub programy P2P
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1206,6 +1240,9 @@
 Categories=System
 Comment=A file system tool
 Type=Directory
+Name[pl]=System plików
+Comment[pl]=Narzędzia do przeglądania systemu plików
+
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1214,6 +1251,8 @@
 Categories=Office
 Comment=Application to manage your finance
 Type=Directory
+Name[pl]=Finanse
+Comment[pl]=Aplikacje do zarządzania finansami
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1222,6 +1261,8 @@
 Categories=Office
 Comment=A flowchart application
 Type=Directory
+Name[pl]=Schematy blokowe
+Comment[pl]=Aplikacje wspomagające tworzenie schematów blokowych
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1230,6 +1271,8 @@
 Categories=
 Comment=Application based on GNOME libraries
 Type=Directory
+Name[pl]=GNOME
+Comment[pl]=Oprogramowanie oparte na bibliotekach GNOME
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1238,6 +1281,8 @@
 Categories= 
 Comment=Application based on GTK+ libraries
 Type=Directory
+Name[pl]=GTK
+Comment[pl]=Oprogramowanie oparte na bibliotekach GTK+
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1246,6 +1291,8 @@
 Categories=Development
 Comment=A GUI designer application
 Type=Directory
+Name[pl]=Projektowanie GUI
+Comment[pl]=Narzędzia wspomagające projektowanie graficznych interfejsów użytkownika
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1392,6 +1439,8 @@
 Categories=Science
 Comment=Geology software
 Type=Directory
+Name[pl]=Geologia
+Comment[pl]=Oprogramowanie geologiczne
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1539,6 +1588,8 @@
 Categories=Network;Audio
 Comment=HAM radio software
 Type=Directory
+Name[pl]=Krótkofalarstwo
+Comment[pl]=Oprogramowanie krótkofalarskie
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1548,6 +1599,8 @@
 Categories=Settings
 Comment=A tool to manage hardware components, like sound cards, video cards or printers
 Type=Directory
+Name[pl]=Zarządzanie sprzętem
+Comment[pl]=Narzędzia do zarządzania sprzętem typu karty muzyczne i graficzne lub drukarki
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1557,6 +1610,7 @@
 Categories=Settings
 Comment=
 Type=Directory
+Name[pl]=Składniki KDE
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1565,6 +1619,8 @@
 Categories=Development
 Comment=IDE application
 Type=Directory
+Name[pl]=IDE
+Comment[pl]=Aplikacje IDE
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1573,6 +1629,8 @@
 Categories=Network
 Comment=An IRC client
 Type=Directory
+Name[pl]=IRC
+Comment[pl]=Klienty IRC-a
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1582,6 +1640,8 @@
 Comment=An instant messaging client
 icon=Folder-Chat
 Type=Directory
+Name[pl]=Komunikatory
+Comment[pl]=Oprogramowanie klienckie komunikatorów
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1590,6 +1650,8 @@
 Categories= 
 Comment=Application based on Java GUI libraries, such as AWT or Swing
 Type=Directory
+Name[pl]=Java
+Comment[pl]=Aplikacje oparte na bibliotekach graficznych Javy, takich jak AWT czy Swing
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1598,6 +1660,8 @@
 Categories=
 Comment=Application based on KDE libraries
 Type=Directory
+Name[pl]=KDE
+Comment[pl]=Aplikacje oparte na bibliotekach KDE
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1683,6 +1747,7 @@
 Name[zh_CN]=儿童游戏
 Name[zh_TW]=小孩的遊戲
 Name[zu]=Imidlalo yabantwana
+Comment[pl]=Gry dla dzieci
 
 
 [DesktopEntry]
@@ -1692,6 +1757,8 @@
 Categories=Education
 Comment=Software to learn foreign languages
 Type=Directory
+Name[pl]=Języki
+Comment[pl]=Oprogramowanie do nauki języków obcych
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1775,6 +1842,7 @@
 Name[zh_CN]=外观和主题
 Name[zh_TW]=外觀 & 主題
 Name[zu]=Ukubukeka & Izingqikithi
+Comment[pl]=Ustawienia wyglądu i motywów
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1784,6 +1852,8 @@
 Comment=Logic games like puzzles, etc
 icon=Folder-Puzzle
 Type=Directory
+Name[pl]=Gry logiczne
+Comment[pl]=Gry logiczne takie jak układanki
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1851,6 +1921,7 @@
 Name[zh_CN]=数学
 Name[zh_TW]=數學
 Name[zu]=Ezezibalo
+Comment[pl]=Oprogramowanie matematyczne
 
 
 [DesktopEntry]
@@ -1860,6 +1931,9 @@
 Categories=Science
 Comment=Medical software
 Type=Directory
+Name[pl]=Medycyna
+Comment[pl]=Oprogramowanie medyczne
+
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1868,6 +1942,8 @@
 Categories=Audio
 Comment=An app related to MIDI
 Type=Directory
+Name[pl]=MIDI
+Comment[pl]=Aplikacje związane z MIDI
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1876,6 +1952,8 @@
 Categories=Audio
 Comment=Just a mixer
 Type=Directory
+Name[pl]=Mieszacze
+Comment[pl]=Mieszacze
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1884,6 +1962,8 @@
 Categories=System
 Comment=Monitor application/applet that monitors some resource or activity
 Type=Directory
+Name[pl]=Monitorowanie
+Comment[pl]=Aplikacje lub aplety monitorujące zasoby lub działania
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1892,6 +1972,8 @@
 Categories= 
 Comment=Application based on Motif libraries
 Type=Directory
+Name[pl]=Motif
+Comment[pl]=Aplikacje oparte na bibliotekach Motif
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1900,6 +1982,8 @@
 Categories=AudioVideo;Education
 Comment=Musical software
 Type=Directory
+Name[pl]=Muzyka
+Comment[pl]=Oprogramowanie muzyczne
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -1984,6 +2068,7 @@
 Name[zh_CN]=Internet 和网络
 Name[zh_TW]=網際網路 & 網路
 Name[zu]=Internet & Uxhumano olusakazekile
+Comment[pl]=Aplikacje sieciowe, takie jak przeglądarki stron WWW
 
 
 [DesktopEntry]
@@ -1993,6 +2078,8 @@
 Categories= 
 Comment=A news reader or a news ticker
 Type=Directory
+Name[pl]=Usenet
+Comment[pl]=Czytniki wiadomości Usenetu
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2001,6 +2088,8 @@
 Categories=Scanning
 Comment=Optical character recognition application
 Type=Directory
+Name[pl]=OCR
+Comment[pl]=Oprogramowanie do rozpoznawania znaków i tekstów w plikach graficznych
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2149,6 +2238,8 @@
 Categories=Network
 Comment=A P2P program
 Type=Directory
+Name[pl]=P2P
+Comment[pl]=Programy P2P
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2157,6 +2248,8 @@
 Categories=Office
 Comment=Tool to manage your PDA
 Type=Directory
+Name[pl]=PDA
+Comment[pl]=Narzędzia do zarządzania palmtopem
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2165,6 +2258,8 @@
 Categories=Settings
 Comment=A package manager application
 Type=Directory
+Name[pl]=Zarządzanie pakietami
+Commet[pl]=Aplikacje do zarządzania pakietami
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2173,6 +2268,8 @@
 Categories=Graphics;Office
 Comment=Camera tools, etc.
 Type=Directory
+Name[pl]=Fotografia
+Comment[pl]=Narządzia do aparatów fotograficznych itp.
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2181,6 +2278,8 @@
 Categories=Science
 Comment=Physics software
 Type=Directory
+Name[pl]=Fizyka
+Comment[pl]=Aplikacje przydatne fizykom
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2190,6 +2289,8 @@
 Comment=Application to play audio/video files
 icon=Folder-Headphones
 Type=Directory
+Name[pl]=Odtwarzacze
+Comment[pl]=Aplikacje do odtwarzania plików audio/video
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2197,7 +2298,7 @@
 X-AfterStep-IndexName=PowerControl
 X-AfterStep-Aliases=X-KDE-PowerControl;X-KDE-settings-power
 Categories=Settings
-Comment=Presentation software
+Comment=Power Control software
 Type=Directory
 Name[af]=Krag Beheer
 Name[ar]=التحكّم بالطّاقة
@@ -2275,7 +2376,7 @@
 Name[zh_CN]=电源控制
 Name[zh_TW]=電源控制
 Name[zu]=Ukulawulwa kwamandla
-
+Comment[pl]=Oprogramowanie do zarządzania energią
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2284,6 +2385,8 @@
 Categories=Office
 Comment=Presentation software
 Type=Directory
+Name[pl]=Prezentacje
+Comment[pl]=Oprogramowanie do tworzenia prezentacji
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2292,6 +2395,8 @@
 Categories=Development
 Comment=A profiling tool
 Type=Directory
+Name[pl]=Profilery
+Comment[pl]=Narzędzia do profilowania programów
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2300,6 +2405,8 @@
 Categories=Office;Development
 Comment=Project management application
 Type=Directory
+Name[pl]=Zarządzanie projektami
+Comment[pl]=Aplikacje do zarządzania projektami
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2310,6 +2417,8 @@
 Comment=Puzzle game
 icon=Folder-Puzzle
 Type=Directory
+Name[pl]=Układanki
+Comment[pl]=Gry - układanki
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2318,6 +2427,8 @@
 Categories= 
 Comment=Application based on Qt libraries
 Type=Directory
+Name[pl]=Qt
+Comment[pl]=Aplikacje oparte na bibliotekach Qt
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2327,6 +2438,8 @@
 Comment=Raster based graphical application
 icon=Folder-Brushes
 Type=Directory
+Name[pl]=Grafika rastrowa
+Comment[pl]=Oprogramowanie do grafiki rastrowej
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2335,6 +2448,8 @@
 Categories=Audio;Video;AudioVideo
 Comment=Application to record audio/video files
 Type=Directory
+Name[pl]=Nagrywanie
+Comment[pl]=Oprogramowanie służące do nagrywania plików audio/video
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2343,6 +2458,8 @@
 Categories=Network
 Comment=A tool to remotely manage your PC
 Type=Directory
+Name[pl]=Zdalny dostęp
+Comment[pl]=Narzędzia do zdalnego zarządzania komputerem
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2351,6 +2468,8 @@
 Categories=Development
 Comment=Applications like cvs or subversion
 Type=Directory
+Name[pl]=Systemy kontroli wersji
+Comment[pl]=Aplikacje takie jak CVS lub Subversion
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2407,7 +2526,7 @@
 Name[nn]=Rogue-aktige spel
 Name[nso]=Dipapadi tsa Bokalatsane
 Name[pa]=ਠੱਗ-ਵਰਗੀਆਂ ਖੇਡਾਂ
-Name[pl]=Gry z rodziny Rogue
+Name[pl]=Gry w stylu Rogue
 Name[pt]=Jogos tipo Rogue
 Name[pt_BR]=Jogos parecidos com Rogue
 Name[ro]=Jocuri violente
@@ -2434,6 +2553,7 @@
 Name[zh_CN]=恶作剧游戏
 Name[zh_TW]=冒險類遊戲
 Name[zu]=Imidlalo enjenge-Rogue
+Comment[pl]=Gry fabularne
 
 
 [DesktopEntry]
@@ -2443,6 +2563,7 @@
 Categories=Application
 Comment=
 Type=Directory
+Name[pl]=Dodatki RedHata
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2451,6 +2572,7 @@
 Categories=Application
 Comment=
 Type=Directory
+Name[pl]=Bazowe aplikacje RedHata
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2460,6 +2582,9 @@
 Comment=Tool to scan a file/text
 icon=Folder-Scanner
 Type=Directory
+Name[pl]=Skanowanie
+Comment[pl]=Narzędzia do skanowania plików lub tekstów
+
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2529,6 +2654,7 @@
 Name[zh_CN]=科学
 Name[zh_TW]=科學
 Name[zu]=Ubuchwepheshe bezesayensi
+Comment[pl]=Oprogramowanie naukowe
 
 
 [DesktopEntry]
@@ -2708,7 +2834,7 @@
 Name[zh_CN]=安全和隐私
 Name[zh_TW]=安全性 & 私密性
 Name[zu]=Ukuvikeleka & Ingasese
-
+Comment[pl]=Narzędzia związane z bezpieczeństwem systemu
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2717,6 +2843,9 @@
 Categories=Audio
 Comment=A sequencer
 Type=Directory
+Name[pl]=Sekwencery
+Comment[pl]=Sekwencery
+
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2792,6 +2921,7 @@
 Name[wa]=Apontiaedjes
 Name[zh_CN]=设置
 Name[zh_TW]=設定
+Comment[pl]=Programy do zarządzania ustawieniami
 
 
 [DesktopEntry]
@@ -2801,6 +2931,8 @@
 Categories= 
 Comment=A shell (an actual specific shell such as bash or tcsh, not a TerminalEmulator)
 Type=Directory
+Name[pl]=Powłoki
+Comment[pl]=Powłoki (takie jak bash lub tcsh, ale nie emulatory terminala)
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2810,6 +2942,8 @@
 Comment=A simulation game
 icon=Folder-People
 Type=Directory
+Name[pl]=Symulacje
+Comment[pl]=Gry - symulacje
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2819,6 +2953,7 @@
 Categories=HardwareSettings
 Comment=
 Type=Directory
+Name[pl]=Ustawienia multimediów
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2828,6 +2963,8 @@
 Comment=A sports game
 icon=Folder-SoccerBall
 Type=Directory
+Name[pl]=Gry sportowe
+Comment[pl]=Gry sportowe
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2836,6 +2973,8 @@
 Categories=Office
 Comment=A spreadsheet
 Type=Directory
+Name[pl]=Arkusze kalkulacyjne
+Comment[pl]=Arkusze kalkulacyjne
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -2921,6 +3060,7 @@
 Name[zh_CN]=策略游戏
 Name[zh_TW]=戰略及策略
 Name[zu]=Amaqhinga & Iplani
+Comment[pl]=Gry taktyczne i strategiczne
 
 
 [DesktopEntry]
@@ -2975,6 +3115,7 @@
 Name[nl]=Systeem
 Name[oc]=Sistemo
 Name[pa]=ਸਿਸਟਮ
+Name[pl]=Systemowe
 Name[pt]=Sistema
 Name[pt_BR]=Sistema
 Name[ro]=Sistem
@@ -3000,6 +3141,7 @@
 Name[zh_CN]=系统
 Name[zh_TW]=系統
 Name[zu]=Isistimu
+Comment[pl]=Narzędzia systemowe, takie jak przeglądarka logów lub monitor sieci
 
 
 [DesktopEntry]
@@ -3147,6 +3289,8 @@
 Comment=A TV application
 icon=Folder-TV
 Type=Directory
+Name[pl]=Telewizja
+Comment[pl]=Aplikacje do oglądania TV
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3211,7 +3355,7 @@
 Name[zh_CN]=教学工具
 Name[zh_TW]=教學工具
 Name[zu]=Amathuluzi Okufundisa
-
+Comment[pl]=Programy dla nauczycieli
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3220,6 +3364,8 @@
 Categories=Network
 Comment=Telephony via PC
 Type=Directory
+Name[pl]=Telefonia
+Comment[pl]=Telefon z komputera
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3304,6 +3450,7 @@
 Name[zh_CN]=终端应用程序
 Name[zh_TW]=終端機程式
 Name[zu]=Abayaleli bangaphandle
+Comment[pl]=Emulatory terminala
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3387,7 +3534,7 @@
 Name[zh_CN]=编辑器
 Name[zh_TW]=編輯器
 Name[zu]=Abalungisi
-
+Comment[pl]=Edytory tekstu
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3443,6 +3590,7 @@
 Name[uz]=Таржима
 Name[zh_CN]=翻译
 Name[zh_TW]=翻譯
+Comment[pl]=Narzędzia ułatwiające tłumaczenia tekstów
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3451,6 +3599,8 @@
 Categories= 
 Comment=An application that is primarily an icon for the "system tray" or "notification area" (apps that open a normal window and just happen to have a tray icon as well should not list this category)
 Type=Directory
+Name[pl]=Ikony tacki systemowej
+Comment[pl]=Aplikacje, których są ikonami w "tacce systemowej" lub "obszarze notyfikacji" (aplikacje, które otwierają normalne okna, ale czasami pokazują też iconę w tacce systemowej, nie powinny być umieszczane w tej kategorii)
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3459,6 +3609,8 @@
 Categories=Audio
 Comment=A tuner
 Type=Directory
+Name[pl]=Tunery
+Comment[pl]=Tunery
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3469,6 +3621,8 @@
 Comment=Small utility application, "Accessories"
 icon=Folder-Screwdriver
 Type=Directory
+Name[pl]=Akcesoria
+Comment[pl]=Aplikacje niewielkie, lecz użyteczne
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3477,6 +3631,8 @@
 Categories=2D Graphics
 Comment=Vector based graphical application
 Type=Directory
+Name[pl]=Grafika wektorowa
+Comment[pl]=Aplikacje grafiki wektorowej
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3486,6 +3642,8 @@
 Comment=A video application
 icon=Folder-MovieProjector
 Type=Directory
+Name[pl]=Wideo
+Comment[pl]=Aplikacje wideo
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3495,6 +3653,8 @@
 Comment=Tool to view e.g. a graphic or pdf file
 icon=Folder-View
 Type=Directory
+Name[pl]=Przeglądarki
+Comment[pl]=Narzędzia do przeglądania zawartości np. plików graficznych lub PDF
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3504,6 +3664,8 @@
 Categories=Network
 Comment=A web browser
 Type=Directory
+Name[pl]=Przeglądarki WWW
+Comment[pl]=Przeglądarki WWW
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3512,6 +3674,8 @@
 Categories=Network;Development
 Comment=A tool for web developers
 Type=Directory
+Name[pl]=Tworzenie stron WWW
+Comment[pl]=Narzędzia dla autorów stron WWW
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3520,6 +3684,8 @@
 Categories=Office
 Comment=A word processor
 Type=Directory
+Name[pl]=Przetwarzanie tesktu
+Comment[pl]=Programy do przetwarzania tektsu
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3528,6 +3694,7 @@
 Categories=Application
 Comment=
 Type=Directory
+Name[pl]=Więcej aplikacjie KDE
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3537,6 +3704,8 @@
 Comment=Search the computer or Internet for files or info.
 icon=Folder-MagnifyingGlass
 Type=Directory
+Name[pl]=Szukaj...
+Comment[pl]=Wyszukiwanie plików lub informacji w lokalnym komputerze lub Internecie
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3551,6 +3720,8 @@
 Comment=Configuration tool for the GUI
 icon=Folder-Desktop2
 Type=Directory
+Name[pl]=Ustawienia pulpitu
+Comment[pl]=Narzędzia konfiguracyjne interfejsu graficznego
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3560,6 +3731,8 @@
 Comment=Applications for use within AfterStep.
 icon=Folder-Puzzle
 Type=Directory
+Name[pl]=Moduły
+Comment[pl]=Aplikacje używane wewnętrznie przez AfterStepa
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3569,6 +3742,8 @@
 Comment=Password-lock a desktop and prevent monitor burn-in.
 icon=Folder-MoonInMonitor
 Type=Directory
+Name[pl]=Wygaszacze ekranu
+Comment[pl]=Wygaszacze i chronione hasłem blokady ekranu
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3578,6 +3753,8 @@
 Comment=Tools for manipulating AfterStep windows.
 icon=Folder-Windows
 Type=Directory
+Name[pl]=Okna
+Comment[pl]=Narzędzia do zarządzania oknami AfterStepa
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3587,6 +3764,9 @@
 Comment=Leave or restart an AfterStep session.
 icon=Folder-Stopsign
 Type=Directory
+Name[pl]=Zamknij
+Comment[pl]=Opuść lub uruchom ponownie sesję Afterstepa.
+
 
 [DesktopEntry]
 Encoding=UTF-8
@@ -3596,4 +3776,6 @@
 Comment=AfterStep Documentation and useful web links.
 icon=Folder-Info
 Type=Directory
+Name[pl]=O AfterStepie
+Comment[pl]=Dokumentacja AfterStepa i przydatne linki
 
--- libAfterImage/transform.c	2010-09-08 12:26:56.000000000 -0500
+++ libAfterImage/transform.c	2011-12-01 00:05:26.000000000 -0600
@@ -2639,7 +2639,7 @@
 		gauss[0] = 1.0;
 		return;
 	}
-	/* after radius of 128 - gaussian degrades into something wierd, 
+	/* after radius of 128 - gaussian degrades into something weird,
 	   since our colors are only 8 bit */
 	if (radius > 128.0) radius = 128.0; 
 	std_dev = (radius - 1) * 0.3003866304;
@@ -2707,7 +2707,7 @@
 		gauss_sums[0] = 1024;
 		return;
 	}
-	/* after radius of 128 - gaussian degrades into something wierd, 
+	/* after radius of 128 - gaussian degrades into something weird,
 	   since our colors are only 8 bit */
 	if (i > 128) i = 128; 
 #if 1
--- libAfterImage/transform.h	2008-04-07 17:46:15.000000000 -0500
+++ libAfterImage/transform.h	2011-12-01 00:05:26.000000000 -0600
@@ -30,7 +30,7 @@
  * operations, thus yielding very good quality. All the transformations
  * are performed in integer math, with the result of greater speeds.
  * Optional MMX inline assembly has been incorporated into some
- * procedures, and allows to achieve considerably better performance on
+ * procedures, and allows one to achieve considerably better performance on
  * compatible CPUs.
  *
  * SEE ALSO
@@ -267,7 +267,7 @@
 /****f* libAfterImage/transform/blur_asimage_gauss()
  * NAME
  * blur_asimage_gauss() Performs Gaussian blurr of the image 
- * ( usefull for drop shadows and the likes ).
+ * ( useful for drop shadows and the likes ).
  * SYNOPSIS
  * ASImage* blur_asimage_gauss( ASVisual* asv, ASImage* src,
  *                              double horz, double vert,
@@ -327,7 +327,7 @@
  * to_width,
  * to_height     - size of the area of the original image to be used
  *                 for new image.
- * affected_hue  - hue in degrees in range 0-360. This allows to limit
+ * affected_hue  - hue in degrees in range 0-360. This allows one to limit
  *                 impact of color adjustment to affect only limited
  *                 range of hues.
  * affected_radius Sets the diapason of the range of affected hues.
@@ -427,7 +427,7 @@
 /****f* libAfterImage/transform/colorize_asimage_vector()
  * NAME
  * colorize_asimage_vector() creates ASImage from double precision indexed 
- * image data - usefull for scientific visualisation.
+ * image data - useful for scientific visualisation.
  * SYNOPSIS
  * Bool colorize_asimage_vector( ASVisual *asv, ASImage *im,
  * 		             	         ASVectorPalette *palette,
@@ -497,9 +497,9 @@
  * asv           - pointer to valid ASVisual structure
  * src           - source ASImage.
  * slice_x_start - ending of the left corners
- * slice_x_end   - begining of the right corners
+ * slice_x_end   - beginning of the right corners
  * slice_y_start - ending of the top corners
- * slice_y_end   - begining of the bottom corners
+ * slice_y_end   - beginning of the bottom corners
  * to_width      - width of the generated image;
  * to_height     - height of the generated image;
  * scaled        - if True - middle part of the image will be scaled, 
--- libAfterImage/ungif.c	2006-10-10 18:54:36.000000000 -0500
+++ libAfterImage/ungif.c	2011-12-01 00:05:26.000000000 -0600
@@ -110,7 +110,7 @@
 
 /* It appears that nobody has bloody debugged giflib with multiimage files where
  * subimages have private colormaps. So it bloody fucks everything up.
- * So we bloody have to cludge it to get something usefull.
+ * So we bloody have to cludge it to get something useful.
  * Oh The pain! The pain!
  */
 int fread_gif( GifFileType *gif, GifByteType* buf, int len )
--- afterstep/wharf	2008-02-12 23:29:04.000000000 -0600
+++ afterstep/wharf	2011-12-01 11:01:12.000000000 -0600
@@ -85,6 +85,7 @@
 # X TErms. Note that only one of this will be displayed on Wharf, as they all
 # have same button name. Change button name ( first column after *Wharf) to make them a separate buttons :
 
+*Wharf term Monitor.xpm Exec "-" x-terminal-emulator &
 *Wharf term "-" DesktopEntry urxvt
 *Wharf term "-" DesktopEntry aterm
 
@@ -98,7 +99,7 @@
 #
 # Midnight commander file manager in the term of choice :
 #
-*Wharf MidnightCommander normal/MCInMonitorShadow ExecInTerm "-" -g 130x35 if(urxvt){-T mc-VerticalTitle -tr -tint blue -fg white -bg black} if(aterm){-T mc-VerticalTitle -tr -tint blue -fg white -bg black} if(Eterm){-O --tint blue -f white -b black) if(rxvt){-tr -fg white -bg black} -e mc &
+*Wharf MidnightCommander normal/MCInMonitorShadow ExecInTerm "-" if(urxvt){-g 130x35 -T mc-VerticalTitle -tr -tint blue -fg white -bg black} if(aterm){-g 130x35 -T mc-VerticalTitle -tr -tint blue -fg white -bg black} if(Eterm){-g 130x35 -O --tint blue -f white -b black) if(rxvt){-g 130x35 -tr -fg white -bg black} -e mc &
 
 #
 # First available GUI file manager :
@@ -118,8 +119,10 @@
 # First available GUI Web Browser :
 #
 *Wharf WebBrowser normal/WWW    Exec x-www-browser &
+*Wharf WebBrowser logos/Firefox Exec "Iceweasel" iceweasel &
 *Wharf WebBrowser logos/Firefox Exec "Firefox" firefox &
 *Wharf WebBrowser logos/Firefox Exec "Firefox2" mozilla-firefox &
+*Wharf WebBrowser logos/mozilla Exec "Iceape" iceape &
 *Wharf WebBrowser logos/mozilla Exec "Mozilla" mozilla &
 *Wharf WebBrowser logos/Opera   Exec "Opera Web Browser" opera &
 *Wharf WebBrowser normal/WWW    Exec sensible-browser &
@@ -127,11 +130,13 @@
 #
 # First available GUI e-mail client :
 #
+*Wharf Mail	logos/Thunderbird Exec "Icedove" icedove &
 *Wharf Mail	logos/Thunderbird Exec "Thunderbird" thunderbird &
 *Wharf Mail	logos/Thunderbird Exec "Thunderbird2" mozilla-thunderbird &
 *Wharf Mail	normal/MailBox2 Exec "mozilla-mail" mozilla --mail &
 *Wharf Mail	normal/MailBox2 Exec "kmail" kmail &
 *Wharf Mail	normal/MailBox2 Exec "balsa" balsa &
+*Wharf Mail	normal/MailBox2 ExecInTerm "Mutt"  -e mutt &
 *Wharf Mail	normal/MailBox2 ExecInTerm "Pine" -title "Pine e-mail and news reader" -e pine &
 
 
@@ -144,8 +149,9 @@
 #
 # First available GUI text editor :
 #
+*Wharf TextEditor medit.png Exec "medit" medit &
 *Wharf TextEditor Text.xpm Exec "NEdit" nedit &
-*Wharf TextEditor Text.xpm Exec "cooledit" cooledit --look next &
+*Wharf TextEditor Text.xpm Exec "cooledit" cooledit &
 *Wharf TextEditor logos/GNU Exec "XEmacs" xemacs &
 *Wharf TextEditor Text.xpm Exec "VIM" gvim &
 
@@ -168,7 +174,7 @@
 # First available IRC client :
 #
 *Wharf IRC  normal/IRCTransparent Exec "XCHAT" xchat &
-*Wharf IRC	normal/IRCTransparent ExecInTerm "BitchX" -title "BitchX IRC" +sb if(aterm){-tr -sh 50 -fg white -bg black} if(Eterm){-O --shade 50 -f white -b black) if(rxvt){-tr -fg white -bg black} if(xterm){-fg white -bg black} -e BitchX irc.freenode.net &
+*Wharf IRC	normal/IRCTransparent ExecInTerm "BitchX" -title "BitchX IRC" if(urxvt){-tr -fg white -bg black} if(aterm){-tr -sh 50 -fg white -bg black} if(Eterm){-O --shade 50 -f white -b black) if(rxvt){-tr -fg white -bg black} if(xterm){-fg white -bg black} -e BitchX irc.freenode.net &
 
 
 # subfolder full of games :
@@ -179,13 +185,17 @@
 # First available Audio player :
 #
 *Wharf AudioPlayer logos/Xmms Exec "X Multi Media System" xmms &
+*Wharf AudioPlayer - Swallow "wmxmms2" wmxmms2 -c blue &
 *Wharf AudioPlayer - Swallow "wmxmms" wmxmms --single &
 *Wharf AudioPlayer - Swallow "ascd" ascd &
+*MonitorWharf AudioPlayer - Swallow "wmusic" wmusic -w &
+
 #
 # Mixer
 #
-*Wharf mixer - Swallow "asmixer" asmixer -g -1-1 &
+*Wharf mixer - Swallow "AlsaMixer.app" AlsaMixer.app -1 Master -2 Master -3 Master &
 *Wharf mixer - Swallow "wmmixer" wmmixer &
+*Wharf mixer - Swallow "asmixer" asmixer -g -1-1 &
 *Wharf mixer - Swallow "asMix" asmix -shape &
 
 #
@@ -258,12 +268,12 @@
 
 
 *MonitorWharf QuitFolder normal/RedLight,dots/3_dots Folder
-*MonitorWharf 	Recycler normal/Recycle Restart "" afterstep -r
+*MonitorWharf 	Restart normal/Recycle Restart "" afterstep -r
 *MonitorWharf 	Quit normal/Stopsign Quit "" afterstep
 *MonitorWharf ~Folder
 
 *MonitorWharf asfsm - Swallow "asfsm_lite" asfsm_lite -bg Grey30 -fg Grey70 -bp None -pbg Grey40 -pfg Grey70 -pbp None -i 30 &
-*MonitorWharf loadmonitor - Swallow "asload" asload -shape -exe "aterm -e top" &
+*MonitorWharf loadmonitor - Swallow "asload" asload -shape -exe "x-terminal-emulator -e top" &
 *MonitorWharf loadmonitor - Swallow "wmavgload" wmavgload -shape -led red &
 *MonitorWharf loadmonitor - Swallow "wmcpuload" wmcpuload -bl -w &
 *MonitorWharf loadmonitor - Swallow "wmload" wmload -shape -led red &
@@ -275,7 +285,7 @@
 *MonitorWharf asmail - Swallow "asmail" asmail -geometry +0+0 &
 
 # One of the clocks - first available :
-*MonitorWharf clock - Swallow "asclock" asclock -shape -24 -position +1+1 &
+*MonitorWharf clock - Swallow "asclock" asclock -shape -24 -theme penguin -position +1+1 &
 *MonitorWharf clock - Swallow "wmclockmon" wmclockmon &
 *MonitorWharf clock - Swallow "wmitime" wmitime &
 *MonitorWharf clock - Swallow "xclock" xclock -bg gray10 -fg cyan -digital -brief &
--- src/WinList2/WinList.c	2009-10-05 11:32:59.000000000 -0500
+++ src/WinList2/WinList.c	2011-12-01 00:14:08.000000000 -0600
@@ -206,7 +206,7 @@
 
 	LoadColorScheme();
 //	ASModuleConfig *asm_config = parse_asmodule_config_all( WinListConfigClass );
-	Config = AS_WINLIST_CONFIG(parse_asmodule_config_all( WinListConfigClass )/*asm_config*/);
+	Config = AS_WINLIST_CONFIG(parse_asmodule_config_all( getWinListConfigClass() )/*asm_config*/);
 	
 /* 	LoadConfig ("winlist", GetOptions); */
 	CheckWinListConfigSanity(Config, &(MyArgs.geometry), MyArgs.gravity, MaxColumns_override, MaxRows_override);
--- libAfterConf/WinList.c	2008-03-21 17:48:51.000000000 -0500
+++ libAfterConf/WinList.c	2011-12-01 00:14:08.000000000 -0600
@@ -191,7 +191,7 @@
 	ASDefaultBalloonTypes
  };
  
-ASModuleConfigClass *WinListConfigClass = &_winlist_config_class;
+ASModuleConfigClass *getWinListConfigClass() { return &_winlist_config_class; }
 
 
 static void
@@ -501,7 +501,7 @@
 	int i ; 
 
     if( Config == NULL )
-        Config = AS_WINLIST_CONFIG(create_ASModule_config(WinListConfigClass));
+        Config = AS_WINLIST_CONFIG(create_ASModule_config(getWinListConfigClass()));
 
 	if( max_columns_override > 0 ) 
 		Config->MaxColumns = max_columns_override ;
--- afterstep/winlist	2007-05-14 16:13:19.000000000 -0500
+++ afterstep/winlist	2011-12-01 11:01:12.000000000 -0600
@@ -9,7 +9,7 @@
 *WinListDefaults
 	Geometry        +0+0
 	MinSize         10000    #will be truncated to thescreen size
-	MaxRows         3
+	MaxRows         1
 	FillRowsFirst
 	UseSkipList
 	
--- libAfterImage/ximage.h	2007-10-16 12:32:49.000000000 -0500
+++ libAfterImage/ximage.h	2011-12-01 00:05:26.000000000 -0600
@@ -203,7 +203,7 @@
  * im    		- source ASImage
  * bitmap       - if True resulting XImage will have depth of 1 bit -
  *                traditional X mask; otherwise it will have depth of 8
- *                (usefull for XFree86 RENDER extension)
+ *                (useful for XFree86 RENDER extension)
  * RETURN VALUE
  * On success returns newly created and encoded XImage of the depth 1 or 8.
  * NULL on failure.
--- src/ASDocGen/xmlproc.c	2006-05-12 18:18:13.000000000 -0500
+++ src/ASDocGen/xmlproc.c	2011-12-01 00:05:26.000000000 -0600
@@ -30,6 +30,8 @@
 
 #define TAG_INFO_AND_ID(tagname)	#tagname, DOCBOOK_##tagname##_ID
 
+#define ASFAQ_NAME "afterstep_faq"
+
 ASDocTagHandlingInfo SupportedDocBookTagInfo[DOCBOOK_SUPPORTED_IDS] = 
 {
 	{ TAG_INFO_AND_ID(unknown), NULL, NULL },
@@ -171,6 +173,14 @@
 				c = cdata[i];
 			if( c == '\"' && get_flags( state->flags, ASXMLI_EscapeDQuotes) ) 
 				fputc( '\"', state->dest_fp );	
+			else if ( c == '-' && state->doc_type == DocType_NROFF ) 
+				fputc( '\\', state->dest_fp );	
+			else if ( c == '.' && state->doc_type == DocType_NROFF ) 
+				fputs( "\\&", state->dest_fp );	
+			else if ( c == '\\' && state->doc_type == DocType_NROFF ) 
+				fputc( '\\', state->dest_fp );	
+			else if ( c == '' && state->doc_type == DocType_NROFF ) 
+				c = '~';
 			fputc( c, state->dest_fp );
 		}		   
 	}	 
@@ -617,7 +627,7 @@
 	{	
 		fprintf( state->dest_fp, "<PRE>");	
 	}else if( state->doc_type == DocType_NROFF )
-		fprintf( state->dest_fp, "\n.nf\n");
+		fprintf( state->dest_fp, "\n.fi\n");
 }
 
 void 
@@ -784,6 +794,10 @@
 		else
 			fwrite( "<UL>", 1, 4, state->dest_fp );
 	}
+	else if (state->doc_type == DocType_NROFF && !strcmp(state->doc_name, ASFAQ_NAME))
+	{
+		fprintf( state->dest_fp, state->header_depth == 2 ? "\n.SH " : "\n.SS " );
+	}		
 }
 
 void 
@@ -862,6 +876,10 @@
 		if( !get_flags( state->flags, ASXMLI_FormalPara ) )
 			fprintf( state->dest_fp, "<br>");	  
 	}
+	else if (state->doc_type == DocType_NROFF && !strcmp(state->doc_name, ASFAQ_NAME))
+	{
+	   fprintf( state->dest_fp, "\n");	   
+	}		
 	close_link(state);
 }
 
@@ -1009,7 +1027,7 @@
 		fprintf( state->dest_fp, "<P class=\"dense\">" );	   			  
 		fprintf( state->dest_fp, "<div class=\"container\">");
 	}else if( state->doc_type == DocType_NROFF )
-		fprintf( state->dest_fp, "\nSource : ");
+		fprintf( state->dest_fp, "\n.in +4n\n");
 
 }
 
@@ -1020,6 +1038,8 @@
 	{
 		fprintf( state->dest_fp, "</div><br></p>");
 	}
+	else if( state->doc_type == DocType_NROFF )
+		fprintf( state->dest_fp, "\n.in\n");
 }
 
 
